.TH DNSMASQ 8
.SH NAME
Dnsmasq \- Un serveur DHCP et cache DNS poids-plume.
.SH SYNOPSIS
.B dnsmasq
.I [OPTION]...
.SH "DESCRIPTION"
.BR dnsmasq
est un serveur Ã  faible empreinte mÃ©moire faisant DNS, TFTP, PXE, annonces de
routeurs et DHCP. Il offre Ã  la fois les services DNS et DHCP pour un rÃ©seau
local (LAN).
.PP
Dnsmasq accepte les requÃªtes DNS et y rÃ©ponds soit en utilisant un petit cache
local, soit en effectuant une requÃªte Ã  un serveur DNS rÃ©cursif externe (par
exemple celui de votre fournisseur d'accÃ¨s internet). Il charge le contenu du
fichier /etc/hosts afin que les noms locaux n'apparaissant pas dans les DNS
globaux soient tout de mÃªme rÃ©solus, et assure Ã©galement la rÃ©solution de nom
pour les hÃ´tes prÃ©sents dans le service DHCP. Il peut aussi agir en temps que
serveur DNS faisant autoritÃ© pour un ou plusieurs domaines, permettant Ã  des
noms locaux d'apparaitre dans le DNS global.
.PP
Le serveur DHCP Dnsmasq DHCP supporte les dÃ©finitions d'adresses statiques et les
rÃ©seaux multiples. Il fournit par dÃ©faut un jeu raisonnable de paramÃ¨tres DHCP,
et peut Ãªtre configurÃ© pour fournir n'importe quelle option DHCP.
Il inclut un serveur TFTP sÃ©curisÃ© en lecture seule permettant le dÃ©marrage via
le rÃ©seau/PXE de clients DHCP et supporte Ã©galement le protocole BOOTP. Le
support PXE est complet, et comprend un mode proxy permettant de fournir des
informations PXE aux clients alors que l'allocation DHCP est effectuÃ©e par un
autre serveur.
.PP
Le serveur DHCPv6 de dnsmasq possÃ¨de non seulement les mÃªmes fonctionalitÃ©s
que le serveur DHCPv4, mais aussi le support des annonces de routeurs ainsi
qu'une fonctionalitÃ© permettant l'addition de ressources AAAA pour des
clients utilisant DHCPv4 et la configuration IPv6 sans Ã©tat (stateless
autoconfiguration).
Il inclut le support d'allocations d'adresses (Ã  la fois en DHCPv6 et en
annonces de routeurs - RA) pour des sous-rÃ©seaux dynamiquement dÃ©lÃ©guÃ©s via
une dÃ©lÃ©gation de prÃ©fixe DHCPv6.
.PP
Dnsmasq est developpÃ© pour de petits systÃ¨mes embarquÃ©s. It tends Ã  avoir
l'empreinte mÃ©moire la plus faible possible pour les fonctions supportÃ©es,
et permet d'exclure les fonctions inutiles du binaire compilÃ©.
.SH OPTIONS
Notes : Il est possible d'utiliser des options sans leur donner de paramÃ¨tre.
Dans ce cas, la fonction correspondante sera dÃ©sactivÃ©e. Par exemple
.B --pid-file=
(sans paramÃ¨tre aprÃ¨s le =) dÃ©sactive l'Ã©criture du fichier PID.
Sur BSD, Ã  moins que le logiciel ne soit compilÃ© avec la bibliothÃ¨que GNU
getopt, la forme longue des options ne fonctionne pas en ligne de commande; Elle
est toujours supportÃ©e dans le fichier de configuration.
.TP
.B --test
VÃ©rifie la syntaxe du ou des fichiers de configurations. Se termine avec le
code de retour 0 si tout est OK, ou un code diffÃ©rent de 0 dans le cas
contraire. Ne dÃ©marre pas Dnsmasq.
.TP
.B \-h, --no-hosts
Ne pas charger les noms du fichier /etc/hosts.
.TP
.B \-H, --addn-hosts=<fichier>
Fichiers d'hÃ´tes additionnels. Lire le fichier spÃ©cifiÃ© en plus de /etc/hosts.
Si 
.B -h
est spÃ©cifiÃ©, lire uniquement le fichier spÃ©cifiÃ©. Cette option peut Ãªtre
rÃ©pÃ©tÃ©e afin d'ajouter d'autres fichiers. Si un rÃ©pertoire est donnÃ©, lis les
fichiers contenus dans ce rÃ©pertoire.
.TP
.B \-E, --expand-hosts
Ajoute le nom de domaine aux noms simples (ne contenant pas de point dans le
nom) contenus dans le fichier /etc/hosts, de la mÃªme faÃ§on que pour le service
DHCP. Notez que cela ne s'applique pas au nom de domaine dans les CNAME, les
enregistrements PTR, TXT, etc...
.TP
.B \-T, --local-ttl=<durÃ©e>
Lorsque Dnsmasq rÃ©pond avec une information provenant du fichier /etc/hosts ou
avec un bail DHCP, il donne un temps de vie (time-to-live) positionnÃ© Ã  zÃ©ro,
afin d'indiquer Ã  la machine faisant la requÃªte que celle-ci  ne doit pas Ãªtre
mise dans un cache. Ceci est le comportement correct dans presque toutes les
situations.
Cette option permet de spÃ©cifier la valeur de time-to-live Ã  retourner (en
secondes). Cela permet de rÃ©duire la charge sur le serveur, mais les clients
risquent d'utiliser des donnÃ©es pÃ©rimÃ©es dans certains cas.
.TP
.B --neg-ttl=<durÃ©e>
Les rÃ©ponses nÃ©gatives provenant des serveurs amonts contiennent normalement
une information de durÃ©e de vie (time-to-live) dans les enregistrements SOA,
information dont dnsmasq se sert pour mettre la rÃ©ponse en cache. Si la rÃ©ponse
du serveur amont omet cette information, dnsmasq ne cache pas la rÃ©ponse. Cette
option permet de doner une valeur de durÃ©e de vie par dÃ©faut (en secondes) que
dnsmasq utilise pour mettre les rÃ©ponses nÃ©gatives dans son cache, mÃªme en
l'absence d'enregistrement SOA.
.TP
.B --max-ttl=<durÃ©e>
DÃ©finie la valeur de TTL maximum qui sera fournie aux clients. La valeur maximum
de TTL spÃ©cifiÃ©e sera fournie aux clients en remplacement de la vraie valeur de
TTL si cette derniÃ¨re est supÃ©rieure. La valeur rÃ©elle de TTL est cependant
conservÃ©e dans le cache afin d'Ã©viter de saturer les serveurs DNS en amont.
.TP
.B --max-cache-ttl=<durÃ©e>
DÃ©finie la valeur de TTL maximum pour les entrÃ©es dans le cache
.TP
.B --auth-ttl=<durÃ©e>
DÃ©finie la valeur de TTL retournÃ©e pour les rÃ©ponses du serveur faisant
autoritÃ©.
.TP
.B \-k, --keep-in-foreground
Ne pas aller en tÃ¢che de fond au lancement, mais en dehors de cela, fonctionner
normalement. Ce mode est prÃ©vu pour les cas oÃ¹ Dnsmasq est lancÃ© par daemontools
ou launchd.
.TP
.B \-d, --no-daemon
Mode debug (dÃ©verminage) : ne pas aller en tÃ¢che de fond, ne pas Ã©crire de
fichier pid, ne pas changer d'identifiant utilisateur, gÃ©nÃ©rer un Ã©tat complet
du cache lors de la rÃ©ception d'un signal SIGUSR1, envoyer les logs sur la
sortie standard d'erreur ("stderr") de mÃªme que dans le syslog, ne pas crÃ©er de
processus fils pour traiter les requÃªtes TCP. A noter que cette option est Ã 
user pour du dÃ©verminage seulement : pour empÃªcher dnsmasq se fonctionner en
mode dÃ©mon en production, utiliser
.B -k.
.TP
.B \-q, --log-queries
Enregistrer les rÃ©sultats des requÃªtes DNS traitÃ©es par Dnsmasq dans un fichier
de traces ("logs"). Active la gÃ©nÃ©ration d'un Ã©tat complet du cache lors de la
rÃ©ception d'un signal SIGUSR1.
.TP
.B \-8, --log-facility=<facility>
DÃ©finit la "facility" dans laquelle Dnsmasq enverra ses entrÃ©es syslog, par
dÃ©faut DAEMON ou LOCAL0 si le mode debug est activÃ©. Si la "facility" contient
au moins un caractÃ¨re "/", alors Dnsmasq considÃ¨re qu'il s'agit d'un fichier et
enverra les logs dans le fichier correspondant Ã  la place du syslog. Si la
"facility" est '-', alors dnsmasq envoie les logs sur la sortie d'erreur
standard stderr. (Les erreurs lors de la lecture de la configuration vont
toujours vers le syslog, mais tous les messages postÃ©rieurs Ã  un dÃ©marrage
rÃ©ussi seront exclusivement envoyÃ©s vers le fichier de logs).
Lorsque Dnsmasq est configurÃ© pour envoyer
ses traces vers un fichier, la rÃ©ception d'un signal SIGUSR2 entraine la
fermeture et rÃ©ouverture du fichier. Cela permet la rotation de fichiers de
traces sans nÃ©cessiter l'arrÃªt de Dnsmasq.
.TP
.B --log-async[=<lignes>]
Permet l'envoi de traces de maniÃ¨re asynchrone, et de maniÃ¨re optionnelle, le
nombre de lignes devant Ãªtre mises dans la file d'attente par Dnsmasq lorsque
l'Ã©criture vers le syslog est lente.
Dnsmasq peut envoyer ses logs de maniÃ¨re asynchrone : cela lui permet de
continuer Ã  fonctionner sans Ãªtre bloquÃ© par le syslog, et permet Ã  syslog
d'utiliser Dnsmasq pour les rÃ©solutions DNS sans risque d'interblocage.
Si la file d'attente devient pleine, Dnsmasq loggera le dÃ©passement de file et
le nombre de messages perdus. La longueur par dÃ©faut de la file d'attente est de
5 et une valeur saine sera comprise entre 5 et 25, avec une limite maximum
imposÃ©e de 100.
.TP
.B \-x, --pid-file=<chemin>
SpÃ©cifie un fichier dans lequel stocker le numÃ©ro de processus (pid). La valeur
par dÃ©faut est /var/run/dnsmasq.pid.
.TP
.B \-u, --user=<nom d'utilisateur>
SpÃ©cifie l'identitÃ© (nom d'utilisateur) prise par Dnsmasq aprÃ¨s le dÃ©marrage.
Dnsmasq doit normalement Ãªtre dÃ©marrÃ© en temps que root ("super-utilisateur"),
mais abandonne ses privilÃ¨ges aprÃ¨s le dÃ©marrage en changeant d'identitÃ©.
Normalement cet utilisateur est l'utilisateur nobody ("personne"), mais il est
possible d'en dÃ©finir un autre par le biais de ce paramÃ¨tre.
.TP
.B \-g, --group=<nom de groupe> 
SpÃ©cifie le groupe sous lequel Dnsmasq s'exÃ©cute. Par dÃ©faut, il s'agit du
groupe "dip", afin de faciliter l'accÃ¨s au fichier /etc/ppp/resolv.conf qui
n'est en gÃ©nÃ©ral pas en lecture par tout le monde.
.TP
.B \-v, --version
Imprime le numÃ©ro de version.
.TP
.B \-p, --port=<port>
Ecoute sur le port numÃ©ro <port> au lieu du port DNS standard (53). ParamÃ©trer
cette valeur Ã  zÃ©ro dÃ©sactive complÃ¨tement la fonction DNS pour ne laisser actif
que le DHCP ou le TFTP.
.TP
.B \-P, --edns-packet-max=<taille>
SpÃ©cifie la taille maximum de paquet UDP EDNS.0 supportÃ© par le relai DNS. Le
dÃ©faut est de 4096, qui est la valeur recommandÃ©e dans la RFC5625.
.TP
.B \-Q, --query-port=<numÃ©ro de port>
Envoie et Ã©coute les requÃªtes DNS sortantes depuis le port UDP spÃ©cifiÃ© par
<numÃ©ro de port>, et non sur un port alÃ©atoire. NOTE : Cette option rends
dnsmasq moins sÃ»r contre les attaques par usurpation DNS ("DNS spoofing"), mais
cela peut permettre d'utiliser moins de ressources et d'Ãªtre plus rapide. Donner
une valeur de zÃ©ro Ã  cette option restaure le comportement par dÃ©faut prÃ©sent dans
les versions de dnsmasq infÃ©rieures Ã  2.43 qui consiste Ã  n'allouer qu'un seul port
allouÃ© par le systÃ¨me d'exploitation.
.TP
.B --min-port=<port>
Ne pas utiliser de port dont le numÃ©ro est infÃ©rieur Ã  la valeur donnÃ©e en paramÃ¨tre
pour les requÃªtes DNS sortantes. Dnsmasq choisis un port source alÃ©atoire pour les
requÃªtes sortantes : lorsque cette option est fournie, les ports utilisÃ©s seront toujours
au dessus de la valeur spÃ©cifiÃ©e. Utile pour des systÃ¨mes derriÃ¨re des dispositifs
garde-barriÃ¨res ("firewalls").
.TP
.B \-i, --interface=<nom d'interface>
N'Ã©couter que sur l'interface rÃ©seau spÃ©cifiÃ©e. Dnsmasq aujoute automatiquement
l'interface locale ("loopback") Ã  la liste des interfaces lorsque l'option
.B --interface
est utilisÃ©e.
Si aucune option
.B --interface
ou
.B --listen-address
n'est donnÃ©e, Dnsmasq Ã©coutera sur toutes les interfaces disponibles sauf
celle(s) spÃ©cifiÃ©e(s) par l'option
.B --except-interface.
Les alias d'interfaces IP (e-g "eth1:0") ne peuvent Ãªtre utilisÃ©s ni avec
.B --interface
ni
.B \--except-interface.
Utiliser l'option 
.B --listen-address
Ã  la place. Un simple joker, consistant d'un '*' final, peut-Ãªtre utilisÃ© dans
les options
.B \--interface 
et
.B \--except-interface
.TP
.B \-I, --except-interface=<interface name>
Ne pas Ã©couter sur l'interface spÃ©cifiÃ©e. Notez que l'ordre dans lesquelles les
options
.B \--listen-address
,
.B --interface
et
.B --except-interface
sont fournies n'importe pas, et que l'option 
.B --except-interface
l'emporte toujours sur les autres.
.TP
.B --auth-server=<domaine>,<interface>|<addresse IP>
Active le mode DNS faisant autoritÃ© pour les requÃªtes arrivant sur cette
interface ou sur cette adresse. Noter que l'interface ou l'adresse n'ont
pas besoin d'Ãªtre mentionÃ©es ni dans
.B --interface
ni dans
.B --listen-address
En effet,
.B --auth-server
va passer outre ceux-ci et fournir un service DNS diffÃ©rent sur l'interface
spÃ©cifiÃ©e. La valeur de <domaine> est l'enregistrement de type "colle"
("glue record"). Il doit correspondre dans le service DNS global avec un
enregistrement de type A et/ou AAAA pointant sur l'adresse sur laquelle dnsmasq
Ã©coute pour le mode DNS faisant autoritÃ©.
.TP 
.B \-2, --no-dhcp-interface=<nom d'interface>
Ne pas fournir de service DHCP sur l'interface spÃ©cifiÃ©e, mais fournir tout de
mÃªme le service DNS.
.TP
.B \-a, --listen-address=<adresse IP>
Ecouter sur la ou les adresse(s) IP spÃ©cifiÃ©e(s). Les options 
.B \--interface
et
.B \--listen-address
peuvent-Ãªtre spÃ©cifiÃ©es simultanÃ©ment, auquel cas un jeu d'interfaces et
d'adresses seront utilisÃ©es. Notez que si
aucune option
.B \--interface
n'est donnÃ©e alors qu'une option 
.B \--listen-address
l'est, Dnsmasq n'Ã©coutera pas automatiquement sur l'interface locale
("loopback"). Pour activer l'Ã©coute sur l'interface locale, il est alors
nÃ©cessaire de fournir explicitement son adresse IP, 127.0.0.1 via l'option
.B \--listen-address.
.TP
.B \-z, --bind-interfaces
Sur les systÃ¨mes qui le supporte, Dnsmasq s'associe avec l'interface joker
("wildcard"), mÃªme lorsqu'il ne doit Ã©couter que sur certaines interfaces. Par
la suite, il rejette les requÃªtes auxquelles il ne doit pas rÃ©pondre. Cette
situation prÃ©sente l'avantage de fonctionner mÃªme lorsque les interfaces vont
et viennent ou changent d'adresses. L'option 
.B --bind-interfaces
force Dnsmasq Ã  ne rÃ©ellement s'associer qu'avec les interfaces sur lesquelles
il doit Ã©couter. L'un des seuls cas oÃ¹ cette option est utile est celui oÃ¹ un
autre serveur de nom (ou une autre instance de Dnsmasq) tourne sur la mÃªme
machine. Utiliser cette option permet Ã©galement d'avoir plusieurs instances de
Dnsmasq fournissant un service DHCP sur la mÃªme machine.
.TP
.B --bind-dynamic
Autorise un mode rÃ©seau intermÃ©diaire entre
.B --bind-interfaces
et le mode par dÃ©faut. Dnsmasq s'associe Ã  une seule interface, ce qui permet
plusieurs instances de dnsmasq, mais si une interface ou adresse apparaissent,
il se mettra automatiquement Ã  Ã©couter sur celles-ci (les rÃ¨gles de contrÃ´le
d'accÃ¨s s'appliquent).
De fait, les interfaces crÃ©Ã©es dynamiquement fonctionnent de la mÃªme faÃ§on que
dans le comportement par dÃ©faut. Ce fonctionnement nÃ©cessite des APIs rÃ©seau
non standard et n'est disponible que sous Linux. Sur les autres plateformes,
le fonctionnement est celui du mode --bind-interfaces.
.TP
.B \-y, --localise-queries
Retourne des rÃ©ponses aux requÃªtes DNS dÃ©pendantes de l'interface sur laquelle
la requÃªte a Ã©tÃ© reÃ§ue, Ã  partir du fichier /etc/hosts. Si un nom dans
/etc/hosts a plus d'une adresse associÃ©e avec lui, et qu'une des adresses au
moins est dans le mÃªme sous-rÃ©seau que l'interface sur laquelle la requÃªte a Ã©tÃ©
reÃ§ue, alors ne retourne que la(les) adresse(s) du sous-rÃ©seau considÃ©rÃ©. Cela
permet d'avoir dans /etc/hosts un serveur avec de multiples adresses, une pour
chacune de ses interfaces, et de fournir aux hÃ´tes l'adresse correcte (basÃ©e sur
le rÃ©seau auquel ils sont attachÃ©s). Cette possibilitÃ© est actuellement limitÃ©e
Ã  IPv4.
.TP
.B \-b, --bogus-priv
Fausse rÃ©solution inverse pour les rÃ©seaux privÃ©s. Toutes les requÃªtes DNS
inverses pour des adresses IP privÃ©es (ie 192.168.x.x, etc...) qui ne sont pas
trouvÃ©es dans /etc/hosts ou dans le fichier de baux DHCP se voient retournÃ©es
une rÃ©ponse "pas de tel domaine" ("no such domain") au lieu d'Ãªtre transmises
aux serveurs de nom amont ("upstream server").
.TP
.B \-V, --alias=[<ancienne IP>]|[<IP de dÃ©but>-<IP de fin>],<nouvelle IP>[,<masque>]
Modifie les adresses IPv4 retournÃ©es par les serveurs de nom amont;
<ancienne IP> est remplacÃ©e par <nouvelle IP>. Si le <masque> optionnel est
fourni, alors toute adresse correspondant Ã  l'adresse <ancienne IP>/<masque>
sera rÃ©Ã©crite. Ainsi par exemple
.B --alias=1.2.3.0,6.7.8.0,255.255.255.0 
modifiera 1.2.3.56 en 6.7.8.56 et 1.2.3.67 en 6.7.8.67. 
Cette fonctionnalitÃ© correspond Ã  ce que les routeurs Cisco PIX appellent
"bidouillage DNS" ("DNS doctoring"). Si l'ancienne IP est donnÃ©e sous la forme
d'une gamme d'adresses, alors seules les adresses dans cette gamme seront
rÃ©ecrites, et non le sous-rÃ©seau dans son ensemble. Ainsi,
.B --alias=192.168.0.10-192.168.0.40,10.0.0.0,255.255.255.0
fait correspondre 192.168.0.10->192.168.0.40 Ã  10.0.0.10->10.0.0.40
.TP 
.B \-B, --bogus-nxdomain=<adresse IP>
Transforme les rÃ©ponses contenant l'adresse IP fournie en rÃ©ponses "pas de tel
domaine" ("no such domain"). Ceci a pour but de neutraliser la modification
sournoise mise en place par Verisign en septembre 2003, lorsqu'ils ont commencÃ©
Ã  retourner l'adresse d'un serveur web publicitaire en rÃ©ponse aux requÃªtes pour
les noms de domaines non enregistrÃ©s, au lieu de la rÃ©ponse correcte "NXDOMAIN".
Cette option demande Ã  Dnsmasq de retourner la rÃ©ponse correcte lorsqu'il
constate ce comportement. L'adresse retournÃ©e par Verisign en septembre 2003
est 64.94.110.11.
.TP
.B \-f, --filterwin2k
Les derniÃ¨res versions de windows font des requÃªtes DNS pÃ©riodiques auxquelles
non seulement les serveurs DNS publics ne peuvent donner de rÃ©ponse, mais qui,
de surcroÃ®t, peuvent poser des problÃ¨mes en dÃ©clenchant des connexions
intempestives pour des liens rÃ©seaux avec des connexions "Ã  la demande". Fournir
cette option active le filtrage des requÃªtes de ce type. Les requÃªtes bloquÃ©es
sont les requÃªtes pour les entrÃ©es de type SOA ou SRV, ainsi que les requÃªtes de
type ANY avec des noms possÃ©dant des caractÃ¨res sous-lignÃ©s (requÃªtes pour des
serveurs LDAP).
.TP
.B \-r, --resolv-file=<fichier>
Lis les adresses des serveurs de nom amont dans le fichier de nom <fichier>,
au lieu du fichier /etc/resolv.conf. Pour le format de ce fichier, voir dans le
manuel pour
.BR resolv.conf (5) 
les entrÃ©es correspondant aux serveurs de noms (nameserver). Dnsmasq peut lire
plusieurs fichiers de type resolv.conf, le premier fichier spÃ©cifiÃ© remplace le
fichier par dÃ©faut, le contenu des suivants est rajoutÃ© dans la liste des
fichiers Ã  consulter. Seul le fichier ayant la derniÃ¨re date de modification
sera chargÃ© en mÃ©moire.
.TP
.B \-R, --no-resolv
Ne pas lire le contenu du fichier /etc/resolv.conf. N'obtenir l'adresse des
serveurs de nom amont que depuis la ligne de commande ou le fichier de
configuration de Dnsmasq.
.TP
.B \-1, --enable-dbus[=<nom de service>]
Autoriser la mise Ã  jour de la configuration de Dnsmasq par le biais d'appel de
mÃ©thodes DBus. Il est possible par ce biais de mettre Ã  jour l'adresse de
serveurs DNS amont (et les domaines correspondants) et de vider le cache. Cette
option nÃ©cessite que Dnsmasq soit compilÃ© avec le support DBus. Si un nom de
service est fourni, dnsmasq fourni un service Ã  ce nom, plutÃ´t qu'avec la
valeur par dÃ©faut :
.B uk.org.thekelleys.dnsmasq
.TP 
.B \-o, --strict-order
Par dÃ©faut, Dnsmasq envoie les requÃªtes Ã  n'importe lequel des serveurs amonts
dont il a connaissance tout en essayant de favoriser les serveurs qu'il sait
fonctionner. Cette option force Dnsmasq Ã  essayer d'interroger, pour chaque
requÃªte, les serveurs DNS dans leur ordre d'apparition dans le fichier
/etc/resolv.conf.
.TP
.B --all-servers
Par dÃ©faut, lorsque dnsmasq a plus d'un serveur amont disponible, il n'envoie
les requÃªtes qu'Ã  un seul serveur. SpÃ©cifier cette option force dnsmasq Ã 
effectuer ses requÃªtes Ã  tous les serveurs disponibles. Le rÃ©sultat renvoyÃ©
au client sera celui fournit par le premier serveur ayant rÃ©pondu.
.TP
.B --stop-dns-rebind
Rejete (et enregistre dans le journal d'activitÃ©) les adresses dans la gamme
d'adresses IP privÃ©e (au sens RFC1918) qui pourraient Ãªtre renvoyÃ©es par les
serveurs amonts suite Ã  une rÃ©solution de nom. Cela bloque les attaques cherchant
Ã  dÃ©tourner de leur usage les logiciels de navigation web ('browser') en s'en
servant pour dÃ©couvrir les machines situÃ©es sur le rÃ©seau local.
.TP
.B --rebind-localhost-ok
Exclue 127.0.0/8 des vÃ©rifications de rÃ©association DNS. Cette gamme d'adresses
est retournÃ©e par les serveurs Realtime Blackhole (RBL, utilisÃ©s dans la
lutte contre le spam), la bloquer peut entraÃ®ner des disfonctionnements de ces
services.
.TP 
.B  --rebind-domain-ok=[<domaine>]|[[/<domaine>/[<domaine>/]
Ne pas dÃ©tecter ni bloquer les actions de type dns-rebind pour ces domaines.
Cette option peut prendre comme valeur soit un nom de domaine soit plusieurs
noms de domains entourÃ©s par des '/', selon une syntaxe similaire Ã  l'option
--server, c-Ã -d :
.B  --rebind-domain-ok=/domaine1/domaine2/domaine3/
.TP
.B \-n, --no-poll
Ne pas vÃ©rifier rÃ©guliÃ¨rement si le fichier /etc/resolv.conf a Ã©tÃ© modifiÃ©.
.TP
.B --clear-on-reload
Lorsque le fichier /etc/resolv.conf est relu, ou si les serveurs amonts sont
configurÃ©s via DBus, vider le cache DNS.
Cela est utile si les nouveaux serveurs sont susceptibles d'avoir des donnÃ©es
diffÃ©rentes de celles stockÃ©es dans le cache.
.TP
.B \-D, --domain-needed
Indique Ã  Dnsmasq de ne jamais transmettre en amont de requÃªtes A ou AAAA pour
des noms simples, c'est Ã  dire ne comprenant ni points ni nom de domaine. Si un
nom n'est pas dans /etc/hosts ou dans la liste des baux DHCP, alors une rÃ©ponse
de type "non trouvÃ©" est renvoyÃ©e.
.TP
.B \-S, --local, --server=[/[<domaine>]/[domaine/]][<Adresse IP>[#<port>][@<Adresse IP source>|<interface>[#<port>]]]
SpÃ©cifie directement l'adresse IP d'un serveur de nom amont. Cette option ne
supprime pas la lecture du fichier /etc/resolv.conf : utiliser pour cela
l'option
.B -R .
Si un ou plusieurs nom(s) de domaine(s) optionnel(s) sont fournis, ce
serveur sera uniquement utilisÃ© uniquement pour ce(s) domaine(s), et toute
requÃªte concernant ce(s) domaine(s) sera adressÃ©e uniquement Ã  ce serveur.
Cette option est destinÃ©e aux serveurs de nom privÃ©s : si vous avez un serveur
de nom sur votre rÃ©seau ayant pour adresse IP 192.168.1.1 et effectuant la
rÃ©solution des noms de la forme xxx.internal.thekelleys.org.uk, alors
.B -S /internal.thekelleys.org.uk/192.168.1.1 
enverra toutes les requÃªtes pour les machines internes vers ce serveur de nom,
alors que toutes les autres requÃªtes seront adressÃ©es aux serveurs indiquÃ©s dans
le fichier /etc/resolv.conf. Une spÃ©cification de nom de domaine vide,
.B // 
possÃ¨de le sens particulier de "pour les noms non qualifiÃ©s uniquement",
c'est-Ã -dire les noms ne possÃ©dant pas de points. Un port non standard peut Ãªtre
rajoutÃ© Ã  la suite des adresses IP en utilisant le caractÃ¨re #. Plus d'une
option
.B -S
est autorisÃ©e, en rÃ©pÃ©tant les domaines et adresses IP comme requis.

Le domaine le plus spÃ©cifique l'emporte sur le domaine le moins spÃ©cifique,
ainsi :
.B --server=/google.com/1.2.3.4
.B --server=/www.google.com/2.3.4.5
enverra les requÃªtes pour *.google.com Ã  1.2.3.4, Ã  l'exception des requÃªtes
*www.google.com, qui seront envoyÃ©es Ã  2.3.4.5.

L'adresse spÃ©ciale '#' signifie "utiliser les serveurs standards", ainsi
.B --server=/google.com/1.2.3.4
.B --server=/www.google.com/#
enverra les requÃªtes pour *.google.com Ã  1.2.3.4, Ã  l'exception des requÃªtes
pour *www.google.com qui seront envoyÃ©es comme d'habitude (c-Ã -d aux serveurs
dÃ©finis par dÃ©faut).

Il est Ã©galement permis de donner une option
.B -S
avec un nom de domaine mais sans
adresse IP; Cela informe Dnsmasq que le domaine est local et qu'il doit rÃ©pondre
aux requÃªtes le concernant depuis les entrÃ©es contenues dans le fichier
/etc/hosts ou les baux DHCP, et ne doit en aucun cas transmettre les requÃªtes
aux serveurs amonts.
.B local
est synonyme de
.B server
("serveur") afin de rendre plus claire l'utilisation de cette option pour cet
usage particulier.

Les adresses IPv6 peuvent inclure un identifiant de zone sous la forme
%interface tel que par exemple
fe80::202:a412:4512:7bbf%eth0.

La chaÃ®ne de caractÃ¨res optionnelle suivant le caractÃ¨re @ permet de dÃ©finir
la source que Dnsmasq doit utiliser pour les rÃ©ponses Ã  ce
serveur de nom. Il doit s'agir d'une des adresses IP appartenant Ã  la machine sur
laquelle tourne Dnsmasq ou sinon la ligne sera ignorÃ©e et une erreur sera
consignÃ©e dans le journal des Ã©vÃ©nements, ou alors d'un nom d'interface. Si un nom
d'interface est donnÃ©, alors les requÃªtes vers le serveur de nom seront envoyÃ©es
depuis cette interface; si une adresse ip est donnÃ©e, alors l'adresse source de
la requÃªte sera l'adresse en question. L'option query-port est ignorÃ©e pour tous
les serveurs ayant une adresse source spÃ©cifiÃ©e, mais il est possible de la donner
directement dans la spÃ©cification de l'adresse source. Forcer les requÃªtes Ã  Ãªtre
Ã©mises depuis une interface spÃ©cifique n'est pas possible sur toutes les plateformes
supportÃ©es par dnsmasq.
.TP
.B \-A, --address=/<domaine>/[domaine/]<adresse IP>
SpÃ©cifie une adresse IP Ã  retourner pour toute requÃªte pour les domaines fournis
en option. Les requÃªtes pour ce(s) domaine(s) ne sont jamais transmises aux
serveurs amonts et reÃ§oivent comme rÃ©ponse l'adresse IP spÃ©cifiÃ©e qui peut Ãªtre
une adresse IPv4 ou IPv6. Pour donner Ã  la fois une adresse IPv4 et une adresse
IPv6 pour un domaine, utiliser plusieurs options
.B -A.
Il faut noter que le
contenu du fichier /etc/hosts et de celui des baux DHCP supplante ceci pour des
noms individuels. Une utilisation courante de cette option est de rediriger la
totalitÃ© du domaine doubleclick.net vers un serveur web local afin d'Ã©viter les
banniÃ¨res publicitaires. La spÃ©cification de domaine fonctionne de la mÃªme faÃ§on
que
.B  --server,
avec la caractÃ©ristique supplÃ©mentaire que
.B /#/
coÃ¯ncide avec tout domaine. Ainsi,
.B --address=/#/1.2.3.4
retournera 1.2.3.4 pour toute requÃªte
n'ayant de rÃ©ponse ni dans /etc/hosts, ni dans les baux DHCP, et n'Ã©tant pas
transmise Ã  un serveur spÃ©cifique par le biais d'une directive
.B --server.
.TP
.B --ipset=/<domaine>/[domaine/]<ipset>[,<ipset>]
Obtient les adresses IP des domaines spÃ©cifiÃ©s et les place dans les groupes
d'IP netfilter (ipset) indiquÃ©s. Domaines et sous-domaines sont rÃ©solus de la
mÃªme faÃ§on que pour --address. Ces groupes d'IP doivent dÃ©jÃ  exister. Voir
ipset(8) pour plus de dÃ©tails.
.TP
.B \-m, --mx-host=<nom de l'hÃ´te>[[,<nom du MX>],<prÃ©ference>]
SpÃ©cifie un enregistrement de type MX pour <nom de l'hÃ´te> retournant le nom
donnÃ© dans <nom du MX> (s'il est prÃ©sent), ou sinon le nom spÃ©cifiÃ© dans
l'option
.B --mx-target
si elle est prÃ©sente. Sinon retourne le nom de la machine
sur laquelle Dnsmasq tourne. La valeur par dÃ©faut (spÃ©cifiÃ©e dans l'option
.B --mx-target
) est utile dans un rÃ©seau local pour rediriger les courriers
Ã©lectroniques vers un serveur central. La valeur de prÃ©fÃ©rence est optionnelle
et vaut par dÃ©faut 1 si elle n'est pas spÃ©cifiÃ©e. Plus d'une entrÃ©e MX peut Ãªtre
fournie pour un hÃ´te donnÃ©.
.TP 
.B \-t, --mx-target=<nom d'hÃ´te>
SpÃ©cifie la rÃ©ponse par dÃ©faut fournie par Dnsmasq pour les requÃªtes sur des
enregistrements de type MX. Voir
.B --mx-host.
Si
.B --mx-target
est donnÃ© mais pas de
.B --mx-host,
alors Dnsmasq retourne comme rÃ©ponse un enregistrement MX
contenant le nom d'hÃ´te spÃ©cifiÃ© dans l'option
.B --mx-target
pour toute requÃªte
concernant le MX de la machine sur laquelle tourne Dnsmasq.
.TP
.B \-e, --selfmx
DÃ©finit, pour toutes les machines locales, un MX correspondant Ã  l'hÃ´te
considÃ©rÃ©. Les machines locales sont celles dÃ©finies dans le fichier /etc/hosts
ou dans un bail DHCP.
.TP 
.B \-L, --localmx
DÃ©finit, pour toutes les machines locales, un enregistrement MX pointant sur
l'hÃ´te spÃ©cifiÃ© par mx-target (ou la machine sur laquelle Dnsmasq tourne). Les
machines locales sont celles dÃ©finies dans le fichier /etc/hosts ou dans un bail
DHCP.
.TP
.B \-W --srv-host=<_service>.<_protocole>.[<domaine>],[<cible>[,<port>[,<prioritÃ©>[,<poids>]]]]
SpÃ©cifie un enregistrement DNS de type SRV. Voir la RFC2782 pour plus de
dÃ©tails. Si le champs <domaine> n'est pas fourni, prends par dÃ©faut la valeur
fournie dans l'option
.B --domain.
La valeur par dÃ©faut pour le domaine est vide et le port par dÃ©faut est 1, alors
que les poids et prioritÃ©s par dÃ©faut sont 0. Attention lorsque vous transposez
des valeurs issues d'une configuration BIND : les ports, poids et prioritÃ©s sont
dans un ordre diffÃ©rents. Pour un service/domaine donnÃ©, plus d'un
enregistrement SRV est autorisÃ© et tous les enregistrements qui coÃ¯ncident sont
retournÃ©s dans la rÃ©ponse.
.TP
.B --host-record=<nom>[,<nom>....][<adresse IPv4>],[<adresse IPv6>]
Ajoute des enregistrements A, AAAA et PTR dans le DNS. Ceci permet d'ajouter
un ou plusieurs noms dans le DNS et de les associer Ã  des enregistrements IPv4
(A) ou IPv6 (AAAA). Un nom peut apparaÃ®tre dans plus d'une entrÃ©e
.B host-record
et de fait Ãªtre associÃ© Ã  plus d'une adresse. Seule la premiÃ¨re entrÃ©e crÃ©Ã©e
l'enregistrement PTR associÃ©e au nom. Ceci correspond Ã  la mÃªme rÃ¨gle que celle
utilisÃ©e lors de la lecture du fichier hosts.
Les options
.B host-record
sont considÃ©rÃ©es lues avant le fichier hosts, ainsi un nom apparaissant dans
une option host-record et dans le fichier hosts n'aura pas d'enregistrement
PTR associÃ© Ã  l'entrÃ©e dans le fichier hosts. A l'inverse du fichier hosts, les
noms ne sont pas Ã©tendus, mÃªme lorsque l'option
.B expand-hosts
est activÃ©e. Les noms longs et les noms courts peuvent apparaitre dans la mÃªme
entrÃ©e 
.B host-record,
c-Ã -d
.B --host-record=laptop,laptop.thekelleys.org,192.168.0.1,1234::100
.TP
.B \-Y, --txt-record=<nom>[[,<texte>],<texte>]
DÃ©finit un enregistrement DNS de type TXT. La valeur de l'enregistrement TXT est
un ensemble de chaÃ®nes de caractÃ¨res, donc un nombre variable de chaÃ®nes de
caractÃ¨res peuvent Ãªtre spÃ©cifiÃ©es, sÃ©parÃ©es par des virgules. Utilisez des
guillemets pour mettre une virgule dans une chaÃ®ne de caractÃ¨res. Notez que la
longueur maximale pour une chaÃ®ne est de 255 caractÃ¨res, les chaÃ®nes plus
longues Ã©tant dÃ©coupÃ©es en morceaux de 255 caractÃ¨res de longs.
.TP
.B --ptr-record=<nom>[,<cible>]
DÃ©finit un enregistrement DNS de type PTR.
.TP
.B --naptr-record=<nom>,<ordre>,<prÃ©fÃ©rence>,<drapeaux>,<service>,<expr. rÃ©guliÃ¨re>[,<remplacement>]
Retourne un enregistrement de type NAPTR, tel que spÃ©cifiÃ© dans le RFC3403.
.TP
.B --cname=<cname>,<cible>
Retourne un enregistrement de type CNAME qui indique que <cname> est en
rÃ©alitÃ© <cible>. Il existe des contraintes importantes sur la valeur
cible; il doit s'agir d'un nom DNS qui est connu de dnsmasq via /etc/hosts
(ou un fichier hÃ´tes additionnel), via DHCP, via interface--name ou par un autre
.B --cname.
Si une cible ne satisfait pas ces critÃ¨res, le CNAME est ignorÃ©. Le CNAME
doit Ãªtre unique, mais il est autorisÃ© d'avoir plus d'un CNAME pointant
vers la mÃªme cible.
.TP
.B --dns-rr=<nom>,<numÃ©ro-RR>,[<donnÃ©es hexadÃ©cimales>]
Retourne un enregistrement DNS arbitraire. Le numÃ©ro correspond au type
d'enregistrement (qui est toujours de la classe C_IN). La valeur de
l'enregistrement est donnÃ©e dans les donnÃ©es hexadÃ©cimales, qui peuvent
Ãªtre de la forme 01:23:45, 01 23 45,+012345 ou n'importe quelle combinaison.
.TP
.B --interface-name=<nom>,<interface>
DÃ©finit un entregistrement DNS associant le nom avec l'adresse primaire sur
l'interface donnÃ©e en argument. Cette option spÃ©cifie un enregistrement de type
A pour le nom donnÃ© en argument de la mÃªme faÃ§on que s'il Ã©tait dÃ©fini par une
ligne de /etc/hosts, sauf que l'adresse n'est pas constante mais dÃ©pendante de
l'interface dÃ©finie. Si l'interface est inactive, non existante ou non
configurÃ©e, une rÃ©ponse vide est fournie. Un enregistrement inverse (PTR) est
Ã©galement crÃ©Ã© par cette option, associant l'adresse de l'interface avec le nom.
Plus d'un nom peut Ãªtre associÃ© Ã  une interface donnÃ©e en rÃ©pÃ©tant cette option
plusieurs fois; dans ce cas, l'enregistrement inverse pointe vers le nom fourni
dans la premiÃ¨re instance de cette option.
.TP
.B --synth-domain=<domaine>,<plage d'adresses>[,<prÃ©fixe>]
CrÃ©Ã© des enregistrements A/AAAA ou PTR pour une plage d'adresses. Les
enregistrements utilisent l'adresse ainsi que les points (ou les deux points
dans le cas d'IPv6) remplacÃ©s par des tirets.

Un exemple devrait rendre cela plus clair :
La configuration
.B --synth-domain=thekelleys.org.uk,192.168.0.0/24,internal-
permet de retourner internal-192-168-0-56.thekelleys.org.uk lors d'une requÃªte
sur l'adresse 192.168.0.56 et vice-versa pour la requÃªte inverse. La mÃªme
logique s'applique pour IPv6, avec la particularitÃ© suivante : les adresses
IPv6 pouvant commencer par '::', mais les noms DNS ne pouvant pas commencer
par '-', si aucun prÃ©fixe n'est donnÃ©, un zÃ©ro est ajoutÃ© en dÃ©but de nom.
Ainsi, ::1 devient 0--1.

La plage d'adresses peut-Ãªtre de la forme
<adresse IP>,<adresse IP> ou <adresse IP>/<masque rÃ©seau>
.TP
.B --add-mac
Ajoute l'adresse MAC du requÃªteur aux requÃªtes DNS transmises aux serveurs
amonts. Cela peut Ãªtre utilisÃ© dans un but de filtrage DNS par les serveurs
amonts. L'adresse MAC peut uniquement Ãªtre ajoutÃ©e si le requÃªteur est sur le
mÃªme sous-rÃ©seau que le serveur dnsmasq. Veuillez noter que le mÃ©canisme
utilisÃ© pour effectuer cela (une option EDNS0) n'est pas encore standardisÃ©e,
aussi cette fonctionalitÃ© doit Ãªtre considÃ©rÃ©e comme expÃ©rimentale. Notez
Ã©galement qu'exposer les adresses MAC de la sorte peut avoir des implications
en termes de sÃ©curitÃ© et de vie privÃ©e. L'avertissement donnÃ© pour --add-subnet
s'applique Ã©galement ici.
.TP
.B --add-subnet[[=<longueur de prÃ©fixe IPv4>],<longueur de prÃ©fixe IPv6>]
Rajoute l'adresse de sous-rÃ©seau du requÃªteur aux requÃªtes DNS transmises
aux serveurs amonts. La quantitÃ© d'adresses transmises dÃ©pend du paramÃ¨tre
longueur du prÃ©fixe : 32 (ou 128 dans le cas d'IPv6) transmet la totalitÃ©
de l'adresse, 0 n'en transmet aucun mais marque nÃ©anmoins la requÃªte ce qui
fait qu'aucun serveur amont ne rajoutera d'adresse client. La valeur par
dÃ©faut est zÃ©ro et pour IPv4 et pour IPv6. A noter que les serveurs amonts
peuvent-Ãªtre configurÃ©s pour retourner des valeurs diffÃ©rentes en fonction
de cette information mais que le cache de dnsmasq n'en tient pas compte.
Si une instance de dnsmasq est configurÃ©e de telle maniÃªre que des valeurs
diffÃ©rentes pourraient-Ãªtre rencontrÃ©s, alors le cache devrait Ãªtre dÃ©sactivÃ©.
.TP
.B \-c, --cache-size=<taille>
DÃ©finit la taille du cache de Dnsmasq. La valeur par dÃ©faut est de 150 noms.
DÃ©finir une valeur de zÃ©ro dÃ©sactive le cache.
.TP
.B \-N, --no-negcache
DÃ©sactive le "cache nÃ©gatif". Le "cache nÃ©gatif" permet Ã  Dnsmasq de se souvenir
des rÃ©ponses de type "no such domain" fournies par les serveurs DNS en amont et
de fournir les rÃ©ponses sans avoir Ã  re-transmettre les requÃªtes aux serveurs
amont.
.TP
.B \-0, --dns-forward-max=<nombre de requÃªtes>
DÃ©finit le nombre maximum de requÃªtes DNS simultanÃ©es. La valeur par dÃ©faut est
150, ce qui devrait Ãªtre suffisant dans la majoritÃ© des configurations. La seule
situation identifiÃ©e dans laquelle cette valeur nÃ©cessite d'Ãªtre augmentÃ©e est
lorsqu'un serveur web a la rÃ©solution de nom activÃ©e pour l'enregistrement de
son journal des requÃªtes, ce qui peut gÃ©nÃ©rer un nombre important de requÃªtes
simultanÃ©es.
.TP
.B --proxy-dnssec
Un resolveur sur une machine cliente peut effectuer la validation DNSSEC de
deux faÃ§ons : il peut effectuer lui-mÃªme les opÃ©rations de chiffrements sur
la rÃ©ponse reÃ§ue, ou il peut laisser le serveur rÃ©cursif amont faire la
validation et positionner un drapeau dans la rÃ©ponse au cas oÃ¹ celle-ci est
correcte. Dnsmasq n'est pas un validateur DNSSEC, aussi il ne peut effectuer
la validation comme un serveur de nom rÃ©cursif, cependant il peut retransmettre
les rÃ©sultats de validation de ses serveurs amonts. Cette option permet
l'activation de cette fonctionalitÃ©. Vous ne devriez utiliser cela que si vous
faites confiance aux serveurs amonts
.I ainsi que le rÃ©seau entre vous et eux.
Si vous utilisez le premier mode DNSSEC, la validation par le resolveur des
clients, cette option n'est pas requise. Dnsmasq retourne toujours toutes les
donnÃ©es nÃ©cessaires par un client pour effectuer la validation lui-mÃªme.
.TP

.B --auth-zone=<domaine>[,<sous-rÃ©seau>[/<longueur de prÃ©fixe>][,<sous-rÃ©seau>[/<longueur de prÃ©fixe>].....]]
DÃ©finie une zone DNS pour laquelle dnsmasq agit en temps que serveur faisant
autoritÃ©. Les enregistrements DNS dÃ©finis localement et correspondant Ã  ce
domaine seront fournis. Les enregistrements A et AAAA doivent se situer dans
l'un des sous-rÃ©seaux dÃ©finis, ou dans un rÃ©seau correspondant Ã  une plage DHCP
(ce comportement peut-Ãªtre dÃ©sactivÃ© par
.B constructor-noauth:
). Le ou les sous-rÃ©seaux sont Ã©galement utilisÃ©(s) pour dÃ©finir les domaines
in-addr.arpa et ip6.arpa servant Ã  l'interrogation DNS inverse. Si la longueur
de prÃ©fixe n'est pas spÃ©cifiÃ©e, elle sera par dÃ©faut de 24 pour IPv4 et 64 pour
IPv6. Dans le cas d'IPv4, la longueur du masque de rÃ©seau devrait-Ãªtre de 8, 16
ou 24, sauf si en cas de mise en place d'une dÃ©lÃ©gation de la zone in-addr.arpa
conforme au RFC 2317.
.TP
.B --auth-soa=<numÃ©ro de sÃ©rie>[,<mainteneur de zone (hostmaster)>[,<rafraichissement>[,<nombre de rÃ©essais>[,<expiration>]]]]
SpÃ©cifie les champs de l'enregistrement de type SOA (Start Of Authority)
associÃ© Ã  une zone pour laquelle le serveur fait autoritÃ©. A noter que cela est
optionnel, les valeurs par dÃ©faut devant convenir Ã  la majoritÃ© des cas.
.TP
.B --auth-sec-servers=<domaine>[,<domaine>[,<domaine>...]]
SpÃ©cifie un ou plusieurs serveur de nom secondaires pour une zone pour
laquelle dnsmasq fait autoritÃ©. Ces serveurs doivent-Ãªtre configurÃ©s pour
rÃ©cupÃ©rer auprÃ¨s de dnsmasq les informations liÃ©es Ã  la zone au travers d'un
transfert de zone, et rÃ©pondre aux requÃªtes pour toutes les zones pour
lesquelles dnsmasq fait autoritÃ©.
.TP
.B --auth-peer=<adresse IP>[,<adresse IP>[,<adresse IP>...]]
SpÃ©cifie la ou les adresses de serveurs secondaires autorisÃ©s Ã  initier des
requÃªtes de transfert de zone (AXFR) pour les zones pour lesquelles
dnsmasq fait autoritÃ©. Si cette option n'est pas fournie, les requÃªtes AXFR
seront acceptÃ©es pour tous les serveurs secondaires.
.TP 
.B --conntrack
Lis le marquage de suivi de connexion Linux associÃ© aux requÃªtes DNS entrantes
et positionne la mÃªme marque au trafic amont utilisÃ© pour rÃ©pondre Ã  ces
requÃ©tes. Cela permet au trafic gÃ©nÃ©rÃ© par Dnsmasq d'Ã©tre associÃ© aux requÃªtes
l'ayant dÃ©clenchÃ©, ce qui est pratique pour la gestion de la bande passante
(accounting) et le filtrage (firewall). Dnsmasq doit pour cela Ãªtre compilÃ©
avec le support conntrack, le noyau doit Ã©galement inclure conntrack et Ãªtre
configurÃ© pour cela. Cette option ne peut pas Ãªtre combinÃ©e avec
--query-port.
.TP
.B \-F, --dhcp-range=[tag:<label>[,tag:<label>],][set:<label>],]<adresse de dÃ©but>[,<adresse de fin>][,<mode>][,<masque de rÃ©seau>[,<broadcast>]][,<durÃ©e de bail>]
.TP
.B \-F, --dhcp-range=[tag:<label>[,tag:<label>],][set:<label>],]<addresse IPv6 de dÃ©but>[,<adresse IPv6 de fin>|constructor:<interface>][,<mode>][,<longueur de prÃ©fixe>][,<durÃ©e de bail>]

Active le serveur DHCP. Les adresses seront donnÃ©es dans la plage comprise entre
<adresse de dÃ©but> et <adresse de fin> et Ã  partir des adresses dÃ©finies
statiquement dans l'option
.B dhcp-host.
Si une durÃ©e de bail est donnÃ©e, alors les baux seront donnÃ©s pour cette
durÃ©e. La durÃ©e de bail est donnÃ©e en secondes, en minutes (exemple : 45m),
en heures (exemple : 1h) ou Ãªtre la chaine de caractÃ¨re "infinite" pour une
durÃ©e indÃ©terminÃ©e. Si aucune valeur n'est donnÃ©e, une durÃ©e de bail par dÃ©faut
de une heure est appliquÃ©e. La valeur minimum pour un bail DHCP est de 2
minutes.

Pour les plages IPv6, la durÃ©e de bail peut-Ãªtre Ã©gale au mot-clef "deprecated"
(obsolÃ¨te); Cela positionne la durÃ©e de vie prÃ©fÃ©rÃ©e envoyÃ©e dans les baux DHCP
ou les annonces routeurs Ã  zÃ©ro, ce qui incite les clients Ã  utiliser d'autres
adresses autant que possible, pour toute nouvelle connexion, en prÃ©alable Ã 
la renumÃ©rotation.

Cette option peut Ãªtre rÃ©pÃ©tÃ©e, avec diffÃ©rentes adresses,
pour activer le service DHCP sur plus d'un rÃ©seau. Pour des rÃ©seaux directement
connectÃ©s (c'est-Ã -dire des rÃ©seaux dans lesquels la machine sur laquelle tourne
Dnsmasq possÃ¨de une interface), le masque de rÃ©seau est optionnel : Dnsmasq la
dÃ©terminera Ã  partir de la configuration des interfaces.

Pour les rÃ©seaux pour lesquels le service DHCP se fait via un relais DHCP
("relay agent"), Dnsmasq est incapable de dÃ©terminer le masque par lui-mÃªme,
aussi il doit Ãªtre spÃ©cifiÃ©, faute de quoi Dnsmasq essaiera de le deviner en
fonction de la classe (A, B ou C) de l'adresse rÃ©seau. L'adresse de broadcast
est toujours optionnelle.

Il est toujours possible d'avoir plus d'une plage DHCP pour un mÃªme
sous-rÃ©seau.

Pour IPv6, les paramÃ¨tres sont lÃ©gÃ¨rement diffÃ©rents : au lieu d'un masque de
rÃ©seau et d'une adresse de broadcast, il existe une longueur de prÃ©fixe
optionnelle. Si elle est omise, la valeur par dÃ©faut est 64. Ã€ la diffÃ©rence
d'IPv4, la longueur de prÃ©fixe n'est pas automatiquement dÃ©duite de la
configuration de l'interface. La taille minimale pour la longueur de prÃ©fixe
est 64.

Pour IPv6 (et IPv6 uniquement), il est possible de dÃ©finir les plages d'une
autre faÃ§on. Dans ce cas, l'adresse de dÃ©part et l'adresse de fin optionnelle
contiennent uniquement la partie rÃ©seau (par exemple ::1) et sont suivies par
.B constructor:<interface>.
Cela forme un modÃ¨le dÃ©crivant comment construire la plage, Ã  partir des
adresses assignÃ©es Ã  l'interface. Par exemple

.B --dhcp-range=::1,::400,constructor:eth0

provoque la recherche d'adresses de la forme <rÃ©seau>::1 sur eth0 et crÃ©e une
plage allant de <rÃ©seau>::1 Ã  <rÃ©seau>:400. Si une interface est assignÃ©e Ã 
plus d'un rÃ©seau, les plages correspondantes seront automatiquement crÃ©Ã©es,
rendues obsolÃ¨tes puis supprimÃ©es lorsque l'adress est rendue obsolÃ¨te puis
supprimÃ©e. Le nom de l'interface peut Ãªtre spÃ©cifiÃ© avec un caractÃ¨re joker '*'
final.

provoque la recherche d'adresses sur eth0 et crÃ©e une plage allant de
<rÃ©seau>::1 Ã  <rÃ©seau>:400. Si l'interface est assignÃ©e Ã 
plus d'un rÃ©seau, les plages correspondantes seront respectivement
automatiquement crÃ©Ã©es, rendues obsolÃ¨tes et supprimÃ©es lorsque l'adresse
est rendue obsolÃ¨te et supprimÃ©e. Le nom de l'interface peut Ãªtre spÃ©cifiÃ© avec
un caractÃ¨re joker '*' final. Les adresses autoconfigurÃ©es, privÃ©es ou
obsolÃ¨tes ne conviennent pas.

Si une plage dhcp-range est uniquement utilisÃ©e pour du DHCP sans-Ã©tat
("stateless") ou de l'autoconfiguration sans Ã©tat ("SLAAC"), alors l'adresse
peut-Ãªtre indiquÃ©e sous la forme '::'

.B --dhcp-range=::,constructor:eth0

Il existe une variante de la syntaxe constructor: qui consiste en l'utilisation
du mot-clef
.B constructor-noauth.
Voir
.B --auth-zone
pour des explications Ã  ce sujet.

L'identifiant de label optionnel
.B set:<label>
fournie une Ã©tiquette alphanumÃ©rique qui identifie ce rÃ©seau, afin de permettre
la fourniture d'options DHCP spÃ©cifiques Ã  chaque rÃ©seau.
Lorsque prÃ©fixÃ© par 'tag:', la signification change, et au lieu de dÃ©finir un
label, il dÃ©finit le label pour laquelle la rÃ¨gle s'applique. Un seul label peut-
Ãªtre dÃ©fini mais plusieurs labels peuvent coÃ¯ncider.

Le mot clef optionnel <mode> peut Ãªtre Ã©gal Ã 
.B static
("statique") ce qui indique Ã  Dnsmasq d'activer le service DHCP pour le rÃ©seau
spÃ©cifiÃ©, mais de ne pas activer l'allocation dynamique d'adresses IP : Seuls
les hÃ´tes possÃ©dant des adresses IP statiques fournies via 
.B dhcp-host
ou prÃ©sentes dans le fichier /etc/ethers seront alors servis par le DHCP. Il est
possible d'activer un mode "fourre-tout" en dÃ©finissant un rÃ©seau statique
comportant uniquement des zÃ©ros, c'est Ã  dire :
.B --dhcp=range=::,static
Cela permet de retourner des rÃ©ponses Ã  tous les paquets de type
Information-request (requÃªte d'information) en mode DHCPv6 sans Ã©tat sur le
sous-rÃ©seau configurÃ©. 

Pour IPv4, le <mode> peut est Ã©gal Ã 
.B proxy
, auquel cas Dnsmasq fournira un service de DHCP proxy pour le sous-rÃ©seau
spÃ©cifiÃ©. (voir
.B pxe-prompt
et
.B pxe-service
pour plus de dÃ©tails).

Pour IPv6, le mode peut-Ãªtre une combinaison des valeurs
.B ra-only, slaac, ra-names, ra-stateless.

.B ra-only
indique Ã  dnsmasq de n'effectuer que des annonces de routeur (Router
Advertisement, RA) sur ce sous-rÃ©seau, et de ne pas faire de DHCP.

.B slaac
indique Ã  dnsmasq d'effectuer des annonces de routeur sur ce sous-rÃ©seau
et de positionner dans celles-ci le bit A, afin que les clients utilisent
des adresses SLAAC. Lorsqu'utilisÃ© conjointement avec une plage DHCP ou des
affectations statiques d'adresses DHCP, les clients disposeront Ã  la fois
d'adresses DHCP assignÃ©es et d'adresses SLAAC.

.B ra-stateless
indique Ã  dnsmasq d'effectuer des annonces de routeur avec les bits 0 et A
positionnÃ©s, et de fournir un service DHCP sans Ã©tat ("stateless"). Les clients
utiliseront des adresses SLAAC, et utiliseront DHCP pour toutes les autres
informations de configuration.

.B ra-names
active un mode qui fourni des noms DNS aux hÃ´tes fonctionnant en double pile
("dual stack") et configurÃ©s pour faire du SLAAC en IPv6. Dnsmasq utilise le
bail IPv4 de l'hÃ´te afin de dÃ©river le nom, le segment de rÃ©seau et l'adresse
MAC et assume que l'hÃ´te disposera d'une adresse IPv6 calculÃ©e via l'algorithme
SLAAC, sur le mÃªme segment de rÃ©seau. Un ping est envoyÃ© Ã  l'adresse, et si une
rÃ©ponse est obtenue, un enregistrement AAAA est rajoutÃ© dans le DNS pour cette
adresse IPv6. Veuillez-noter que cela n'arrive que pour les rÃ©seaux directement
connectÃ©s (et non ceux pour lesquels DHCP se fait via relai), et ne
fonctionnera pas si un hÃ´te utilise les "extensions de vie privÃ©e"
("privacy extensions").
.B ra-names
peut-Ãªtre combinÃ© avec
.B ra-stateless
et
.B slaac.

.TP
.B \-G, --dhcp-host=[<adresse matÃ©rielle>][,id:<identifiant client>|*][,set:<label>][,<adresse IP>][,<nom d'hÃ´te>][,<durÃ©e de bail>][,ignore]
SpÃ©cifie les paramÃ¨tres DHCP relatifs Ã  un hÃ´te. Cela permet Ã  une machine
possÃ©dant une adresse matÃ©rielle spÃ©cifique de se voir toujours allouÃ©e les
mÃªmes nom d'hÃ´te, adresse IP et durÃ©e de bail. Un nom d'hÃ´te spÃ©cifiÃ© comme
ceci remplace le nom fourni par le client DHCP de la machine hÃ´te. Il est
Ã©galement possible d'omettre l'adresse matÃ©rielle et d'inclure le nom d'hÃ´te,
auquel cas l'adresse IP et la durÃ©e de bail s'appliqueront Ã  toute machine se
rÃ©clamant de ce nom. Par exemple
.B --dhcp-host=00:20:e0:3b:13:af,wap,infinite 
spÃ©cifie Ã  Dnsmasq de fournir Ã  la machine d'adresse matÃ©rielle
00:20:e0:3b:13:af le nom, et un bail de durÃ©e indÃ©terminÃ©e.

.B --dhcp-host=lap,192.168.0.199 
spÃ©cifie Ã  Dnsmasq d'allouer toujours Ã  la machine portant le nom lap
l'adresse IP 192.168.0.199.

Les adresses allouÃ©es de la sorte ne sont pas contraintes Ã  une plage d'adresse
spÃ©cifiÃ©e par une option --dhcp-range, mais elles se trouver dans le mÃªme
sous-rÃ©seau qu'une plage dhcp-range valide. Pour les sous-rÃ©seaux qui n'ont pas
besoin d'adresses dynamiquement allouÃ©es, utiliser le mot-clef "static" dans la
dÃ©claration de plage d'adresses dhcp-range.

Il est possible d'utiliser des identifiants clients (appellÃ© "DUID client" dans
le monde IPv6) plutÃ´t que des adresses matÃ©rielles pour identifier les hÃ´tes,
en prÃ©fixant ceux-ci par 'id:'. Ainsi, 
.B --dhcp-host=id:01:02:03:04,..... 
rÃ©fÃ¨re Ã  l'hÃ´te d'identifiant 01:02:03:04. Il est Ã©galement possible de
spÃ©cifier l'identifiant client sous la forme d'une chaÃ®ne de caractÃ¨res, comme
ceci :
.B --dhcp-host=id:identifiantclientsousformedechaine,..... 

Un seul
.B dhcp-host 
peut contenir une adresse IPv4, une adresse IPv6, ou les deux en mÃªme temps.
Les adresses IPv6 doivent-Ãªtre mises entre crochets comme suit :
.B --dhcp-host=laptop,[1234::56]
Les adresses IPv6 peuvent ne contenir que la partie identifiant de client :
.B --dhcp-host=laptop,[::56]
Dans ce cas, lorsque des plages dhcp sont dÃ©finies automatiquement par le biais
de constructeurs, la partie rÃ©seau correspondante est rajoutÃ©e Ã  l'adresse.

A noter que pour le DHCP IPv6, l'adresse matÃ©rielle n'est pas toujours
disponible, bien que ce soit toujours le cas pour des clients directement
connectÃ©s (sur le mÃªme domaine de broadcast) ou pour des clients utilisant
des relais DHCP qui supportent la RFC 6939.

En DHCPv4, l'option spÃ©ciale id:* signifie : "ignorer tout identifiant client et n'utiliser
que l'adresse matÃ©rielle". Cela est utile lorsqu'un client prÃ©sente un
identifiant client mais pas les autres.

Si un nom apparaÃ®t dans /etc/hosts, l'adresse associÃ©e peut Ãªtre allouÃ©e Ã  un
bail DHCP mais seulement si une option
.B --dhcp-host
spÃ©cifiant le nom existe par ailleurs. Seul un nom d'hÃ´te peut-Ãªtre donnÃ© dans
une option
.B dhcp-host
, mais les alias sont possibles au travers de l'utilisation des CNAMEs. (Voir
.B --cname
).
Le mot clef "ignore" ("ignorer") indique
Ã  Dnsmasq de ne jamais fournir de bail DHCP Ã  une machine. La machine peut Ãªtre
spÃ©cifiÃ©e par son adresse matÃ©rielle, son identifiant client ou son nom d'hÃ´te.
Par exemple
.B --dhcp-host=00:20:e0:3b:13:af,ignore
Cela est utile lorsqu'un autre serveur DHCP sur le rÃ©seau doit Ãªtre utilisÃ© par
certaines machines.

Le paramÃ¨tre set:<identifiant rÃ©seau> permet de dÃ©finir un
identifiant de rÃ©seau lorsque l'option dhcp-host est utilisÃ©e. Cela peut servir
Ã  sÃ©lectionner des options DHCP juste pour cet hÃ´te. Plus d'un label peut Ãªtre
fourni dans une directive dhcp-host (et dans cette seule directive). Lorsqu'une
machine coÃ¯ncide avec une directive dhcp-host (ou une impliquÃ©e par
/etc/ethers), alors le label rÃ©servÃ© "known" ("connu") est associÃ©. Cela permet Ã 
Dnsmasq d'Ãªtre configurÃ© pour ignorer les requÃªtes issus de machines inconnue
 par le biais de 
.B --dhcp-ignore=tag:!known.

Les adresses ethernet (mais pas les identifiants clients) peuvent Ãªtre dÃ©finies
avec des octets joker, ainsi par exemple
.B --dhcp-host=00:20:e0:3b:13:*,ignore 
demande Ã  Dnsmasq d'ignorer une gamme d'adresses matÃ©rielles. Il est  Ã  noter
que "*" doit-Ãªtre prÃ©cÃ©dÃ© d'un caractÃ¨re d'Ã©chappement ou mis entre guillemets
lorsque spÃ©cifiÃ© en option de ligne de commande, mais pas dans le fichier de
configuration.

Les adresses matÃ©rielles coÃ¯ncident en principe avec n'importe
quel type de rÃ©seau (ARP), mais il est possible de les limiter Ã  un seul type
ARP en les prÃ©cÃ©dant du type ARP (en HexadÃ©cimal) et de "-". Ainsi
.B --dhcp-host=06-00:20:e0:3b:13:af,1.2.3.4 
coÃ¯ncidera uniquement avec des adresses matÃ©rielles Token-Ring, puisque le type
ARP pour une adresse Token-Ring est 6.

Un cas spÃ©cial, pour IPv4, correspond Ã  l'inclusion d'une ou plusieurs adresses
matÃ©rielles, c-Ã -d :
.B --dhcp-host=11:22:33:44:55:66,12:34:56:78:90:12,192.168.0.2.
Cela permet Ã  une adresse IP d'Ãªtre associÃ© Ã  plusieurs adresses
matÃ©rielles, et donne Ã  dnsmasq la permission d'abandonner un bail DHCP
attribuÃ© Ã  l'une de ces adresses lorsqu'une autre adresse dans la liste
demande un bail. Ceci est une opÃ©ration dangereuse qui ne fonctionnera
de maniÃ¨re fiable que si une adresse matÃ©rielle est active Ã  un moment
donnÃ© et dnsmasq n'a aucun moyen de s'assurer de cela. Cela est utile,
par exemple, pour allouer une adresse IP stable Ã  un laptop qui
aurait Ã  la fois une connexion filaire et sans-fil.
.TP
.B --dhcp-hostsfile=<chemin>
Lis les informations d'hÃ´tes DHCP dans le fichier spÃ©cifiÃ©. Si l'argument est
un chemin vers un rÃ©pertoire, lis tous les fichiers de ce rÃ©pertoire. Le
fichier contient des informations Ã  raison d'un hÃ´te par ligne. Le format
d'une ligne est la mÃªme que le texte fourni Ã  la droite sur caractÃ¨re "=" dans
l'option
.B --dhcp-host.
L'avantage de stocker les informations sur les hÃ´tes DHCP dans ce fichier est
que celles-ci peuvent Ãªtre modifiÃ©es sans recharger Dnsmasq; le fichier sera
relu lorsque Dnsmasq reÃ§oit un signal SIGHUP.
.TP
.B --dhcp-optsfile=<chemin>
Lis les informations relatives aux options DHCP dans le fichier spÃ©cifiÃ©. Si
l'argument est un chemin vers un rÃ©pertoire, lis tous les fichiers de ce
rÃ©pertoire. L'intÃ©rÃªt d'utiliser cette option est le mÃªme que pour
 --dhcp-hostsfile : le fichier spÃ©cifiÃ© sera rechargÃ© Ã  la rÃ©ception par
dnsmasq d'un signal SIGHUP. Notez qu'il est possible d'encoder l'information
via
.B --dhcp-boot
en utilisant les noms optionnels bootfile-name, server-ip-address et
tftp-server. Ceci permet d'inclure ces options dans un fichier "dhcp-optsfile".DNSMASQ_SUPPLIED_HOSTNAME
.TP
.B \-Z, --read-ethers
Lis les informations d'hÃ´tes DHCP dans le fichier /etc/ethers. Le format de
/etc/ethers est une adresse matÃ©rielle suivie, soit par un nom d'hÃ´te, soit par
une adresse IP sous la forme de 4 chiffres sÃ©parÃ©s par des points. Lorsque lu
par Dnsmasq, ces lignes ont exactement le mÃªme effet que l'option
.B --dhcp-host
contenant les mÃªmes informations. /etc/ethers est relu Ã  la rÃ©ception d'un
signal SIGHUP par Dnsmasq. Les adresses IPv6 ne sont PAS lues dans /etc/ethers.
.TP
.B \-O, --dhcp-option=[tag:<label>,[tag:<label>]][encap:<option>,][vi-encap:<entreprise>,][vendor:[<classe_vendeur>],][<option>|option:<nom d'option>|option6:<option>|option6:<nom d'option>],[<valeur>[,<valeur>]]
SpÃ©cifie des options diffÃ©rentes ou supplÃ©mentaires pour des clients DHCP. Par
dÃ©faut, Dnsmasq envoie un ensemble standard d'options aux clients DHCP : le
masque de rÃ©seau et l'adresse de broadcast sont les mÃªmes que pour l'hÃ´te
sur lequel tourne Dnsmasq, et le serveur DNS ainsi que la route par dÃ©faut
prennent comme valeur l'adresse de la machine sur laquelle tourne Dnsmasq. 
(Des rÃ¨gles Ã©quivalentes s'appliquent en IPv6). Si une option de nom de domaine
a Ã©tÃ© dÃ©finie, son contenu est transmis. Cette option de configuration permet
de changer toutes ces valeurs par dÃ©faut, ou de spÃ©cifier d'autres options.
L'option DHCP Ã  transmettre peut Ãªtre fournie sous forme d'un nombre dÃ©cimal 
ou sous la forme "option:<nom d'option>". Les nombres correspondants aux options
sont dÃ©finis dans la RFC2132 et suivants. Les noms d'options connus par Dnsmasq 
peuvent Ãªtre obtenus via "Dnsmasq --help dhcp". Par exemple, pour dÃ©finir la
route par dÃ©faut Ã  192.168.4.4, il est possible de faire
.B --dhcp-option=3,192.168.4.4 
ou
.B --dhcp-option = option:router, 192.168.4.4
ou encore, pour positionner l'adresse du serveur de temps Ã  192.168.0.4, on peut
faire
.B --dhcp-option = 42,192.168.0.4 
ou 
.B --dhcp-option = option:ntp-server, 192.168.0.4
L'adresse 0.0.0.0 prends ici le sens "d'adresse de la machine sur laquelle
tourne Dnsmasq". Les types de donnÃ©es autorisÃ©es sont des adresses IP sous la
forme de 4 chiffres sÃ©parÃ©s par des points, un nombre dÃ©cimal, une liste de
caractÃ¨res hexadÃ©cimaux sÃ©parÃ©s par des 2 points, ou une chaÃ®ne de caractÃ¨res.
Si des labels optionnels sont fournis, alors cette option n'est envoyÃ©e
qu'aux rÃ©seaux dont tous les labels coÃ¯ncident avec ceux de la requÃªte.

Un traitement spÃ©cial est effectuÃ© sur les chaÃ®nes de caractÃ¨res fournies pour
l'option 119, conformÃ©ment Ã  la RFC 3397. Les chaÃ®nes de caractÃ¨res ou les
adresses IP sous forme de 4 chiffres sÃ©parÃ©s par des points donnÃ©s en arguments
de l'option 120 sont traitÃ©s conformÃ©ments Ã  la RFC 3361. Les adresses IP sous
forme de 4 chiffres sÃ©parÃ©s par des points suivies par une barre montante "/",
puis une taille de masque sont encodÃ©s conformÃ©ments Ã  la RFC 3442.

Les options IPv6 sont fournies en utilisant le mot-clef
.B option6:
suivi par le numÃ©ro d'option ou le nom d'option. L'espace de nommage des options
IPv6 est disjint de l'espace de nommage des options IPv4. Les adresses IPv6
en option doivent Ãªtre entourÃ©es de crochets, comme par exemple :
.B --dhcp-option=option6:ntp-server,[1234::56]

Attention : aucun test n'Ã©tant fait pour vÃ©rifier que des donnÃ©es d'un type
adÃ©quat sont envoyÃ©es pour un numÃ©ro d'option donnÃ©, il est tout Ã  fait possible
de persuader Dnsmasq de gÃ©nÃ©rer des paquets DHCP illÃ©gaux par une utilisation
incorrecte de cette option. Lorsque la valeur est un nombre dÃ©cimal, Dnsmasq
doit dÃ©terminer la taille des donnÃ©es. Cela est fait en examinant le numÃ©ro de
l'option et/ou la valeur, mais peut-Ãªtre Ã©vitÃ© en rajoutant un suffixe d'une
lettre comme suit :
b = un octet, s = 2 octets, i = 4 octets. Cela sert essentiellement pour des
options encapsulÃ©es de classes de vendeurs (voir plus bas), pour lesquelles 
Dnsmasq ne peut dÃ©terminer la taille de la valeur. Les donnÃ©es d'options
consistant uniquement de points et de dÃ©cimaux sont interprÃ©tÃ©es par Dnsmasq
comme des adresses IP, et envoyÃ©es comme telles. Pour forcer l'envoi sous forme
de chaÃ®ne de caractÃ¨re, il est nÃ©cessaire d'utiliser des guillemets doubles. Par
exemple, l'utilisation de l'option 66 pour fournir une adresse IP sous la forme
d'une chaÃ®ne de caractÃ¨res comme nom de serveur TFTP, il est nÃ©cessaire de faire
comme suit :
.B --dhcp-option=66,"1.2.3.4"

Les options encapsulÃ©es de classes de vendeurs peuvent-Ãªtre aussi spÃ©cifiÃ©es 
(pour IPv4 seulement) en utilisant
.B --dhcp-option
: par exemple
.B --dhcp-option=vendor:PXEClient,1,0.0.0.0
envoie l'option encapsulÃ©e de classe de vendeur "mftp-address=0.0.0.0" Ã 
n'importe quel client dont la classe de vendeur correspond Ã  "PXEClient". La
correspondance pour les classes de vendeur s'effectue sur des sous-chaÃ®nes de
caractÃ¨res (voir
.B --dhcp-vendorclass
pour plus de dÃ©tails). Si une option de
classe de vendeur (numÃ©ro 60) est envoyÃ©e par Dnsmasq, alors cela est utilisÃ©
pour sÃ©lectionner les options encapsulÃ©es, de prÃ©fÃ©rence Ã  toute option envoyÃ©e
par le client. Il est possible d'omettre complÃ¨tement une classe de vendeur :
.B --dhcp-option=vendor:,1,0.0.0.0
Dans ce cas l'option encapsulÃ©e est toujours envoyÃ©e.

En IPv4, les options peuvent-Ãªtre encapsulÃ©es au sein d'autres options :
par exemple
.B --dhcp-option=encap:175, 190, "iscsi-client0"
enverra l'option 175, au sein de laquelle se trouve l'option 190.
Plusieurs options encapsulÃ©es avec le mÃªme numÃ©ro d'option seront correctement
combinÃ©es au sein d'une seule option encapsulÃ©e. Il n'est pas possible de
spÃ©cifier encap: et vendor: au sein d'une mÃªme option dhcp.

La derniÃ¨re variante pour les options encapsulÃ©es est "l'option de Vendeur
identifiant le vendeur" ("Vendor-Identifying Vendor Options") telle que
dÃ©crite dans le RFC3925. Celles-ci sont spÃ©cifiÃ©es comme suit :
.B --dhcp-option=vi-encap:2, 10, "text"
Le numÃ©ro dans la section vi-encap: est le numÃ©ro IANA de l'entreprise servant
Ã  identifier cette option. Cette forme d'encapsulation est Ã©galement supportÃ©e
en IPv6.

L'adresse 0.0.0.0 n'est pas traitÃ©e de maniÃ¨re particuliÃ¨re lorsque fournie dans
une option encapsulÃ©e.
.TP
.B --dhcp-option-force=[tag:<label>,[tag:<label>]][encap:<option>,][vi-encap:<entreprise>,][vendor:[<classe_vendeur>],][<option>|option:<nom d'option>],[<valeur>[,<valeur>]]
Cela fonctionne exactement de la mÃªme faÃ§on que
.B --dhcp-option
sauf que cette option sera toujours envoyÃ©e, mÃªme si le client ne la demande pas
dans la liste de paramÃªtres requis. Cela est parfois nÃ©cessaire, par exemple lors
de la fourniture d'options Ã  PXELinux.
.TP
.B --dhcp-no-override
(IPv4 seulement) DÃ©sactive la rÃ©utilisation des champs DHCP nom de serveur et
nom de fichier comme espace supplÃ©mentaire pour les options. Si cela est
possible, dnsmasq dÃ©place les informations sur le serveur de dÃ©marrage
et le nom de fichier (fournis par 'dhcp-boot') en dehors des champs
dÃ©diÃ©s Ã  cet usage dans les options DHCP. Cet espace supplÃ©mentaire est
alors disponible dans le paquet DHCP pour d'autres options, mais peut, dans
quelques rares cas, perturber des clients vieux ou dÃ©fectueux. Cette
option force le comportement Ã  l'utilisation des valeurs "simples et sÃ»res"
afin d'Ã©viter des problÃ¨mes dans de tels cas.
.TP
.B --dhcp-relay=<adresse locale>,<adresse de serveur>[,<interface]
Configure dnsmasq en temps que relais DHCP.  L'adresse locale est une
adresse allouÃ©e Ã  l'une interface de la machine sur laquelle tourne dnsmasq.
Toutes les requÃªtes DHCP arrivant sur cette interface seront relayÃ©es au
serveur DHCP distant correspondant Ã  l'adresse de serveur indiquÃ©e. Il est
possible de relayer depuis une unique adresse locale vers diffÃ©rents serveurs
distant en spÃ©cifiant plusieurs fois l'option dhcp-relay avec la mÃªme adresse
locale et diffÃ©rentes adresses de serveur. L'adresse de serveur doit-Ãªtre
sous forme numÃ©rique. Dans le cas de DHCPv6, l'adresse de serveur peut-Ãªtre
l'adresse de multicast ff05::1:3 correspondant Ã  tous les serveurs DHCP. Dans
ce cas, l'interface doit-Ã©tre spÃ©cifiÃ©e et ne peut comporter de caractÃ¨re
joker. Elle sera utilisÃ©e pour indiquer l'interface Ã  partir de laquelle le
multicast pourra atteindre le serveur DHCP.

Le contrÃ´le d'accÃ¨s pour les clients DHCP suivent les mÃªmes rÃ¨gles que pour
les serveurs DHCP : voir --interface, --except-interface, etc. Le nom
d'interface optionel dans l'option dhcp-relay comporte une autre fonction :
il contrÃ´le l'interface sur laquelle la rÃ©ponse du serveur sera acceptÃ©e. Cela
sert par exemple dans des configurations Ã  3 interfaces : une Ã  partir de
laquelle les requÃªtes sont relayÃ©es, une seconde permettant de se connecter Ã 
un serveur DHCP, et une troisiÃ¨me reliÃ©e Ã  un rÃ©seau non-sÃ©curisÃ© tel
qu'internet. Cela permet d'Ã©viter l'arrivÃ©e de requÃªtes usurpÃ©es via cette
troisiÃ¨me interface.

Il est permis de configurer dnsmasq pour fonctionner comme serveur DHCP sur
certaines interfaces et en temps que relais sur d'autres. Cependant, mÃªme s'il
est possible de configurer dnsmasq de telle maniÃ¨re qu'il soit Ã  la fois
serveur et relais pour une mÃªme interface, cela n'est pas supportÃ© et la
fonction de relais prendra le dessus.

Le relais DHCPv4 et le relais DHCPv6 sont tous les deux supportÃ©s, mais il
n'est pas possible de relayer des requÃªtes DHCPv4 Ã  un serveur DHCPv6 et
vice-versa.
.TP
.B \-U, --dhcp-vendorclass=set:<label>,[enterprise:<numÃ©ro IANA d'enterprise>,]<classe de vendeur>

Associe une chaÃ®ne de classe de vendeur Ã  un label. La plupart
des clients DHCP fournissent une "classe de vendeur" ("vendor class") qui
reprÃ©sente, d'une certaine faÃ§on, le type d'hÃ´te. Cette option associe des
classes de vendeur Ã  des labels, de telle sorte que des options DHCP peuvent-Ãªtre
fournie de maniÃ¨re sÃ©lective aux diffÃ©rentes classes d'hÃ´tes. Par exemple,
.B dhcp-vendorclass=set:printers,Hewlett-Packard JetDirect
ou
.B dhcp-vendorclass=printers,Hewlett-Packard JetDirect
permet de n'allouer des options qu'aux imprimantes HP de la maniÃ¨re suivante :
.B --dhcp-option=tag:printers,3,192.168.4.4
La chaÃ®ne de caractÃ¨res de la classe de vendeur founie en argument est cherchÃ©e
en temps que sous-chaÃ®ne de caractÃ¨res au sein de la classe de vendeur fournie
par le client, de faÃ§on Ã  permettre la recherche d'un sous-ensemble de la chaÃ®ne
de caractÃ¨res ("fuzzy matching"). Le prÃ©fixe set: est optionnel mais autorisÃ©
afin de conserver une certaine homogÃ©nÃ©itÃ©.

Notez qu'en IPv6 (et seulement en IPv6), les noms de classes de vendeurs
sont dans un espace de nom associÃ© au numÃ©ro attribuÃ© Ã  l'entreprise par
l'IANA. Ce numÃ©ro est fourni par le biais du mot-clef enterprise: et seules
les classes de vendeurs associÃ©es au numÃ©ro spÃ©cifiÃ© seront cherchÃ©es.
.TP
.B \-j, --dhcp-userclass=set:<label>,<classe utilisateur>
Associe une chaÃ®ne de classe d'utilisateur Ã  un label (effectue la
recherche sur des sous-chaÃ®nes, comme pour les classes de vendeur). La plupart
des clients permettent de configurer une "classe d'utilisateur". Cette option
associe une classe d'utilisateur Ã  un label, de telle maniÃ¨re qu'il soit
possible de fournir des options DHCP spÃ©cifiques Ã  diffÃ©rentes classes d'hÃ´tes.
Il est possible, par exemple, d'utiliser ceci pour dÃ©finir un serveur
d'impression diffÃ©rent pour les hÃ´tes de la classe "comptes" et ceux de la
classe "ingÃ©nierie".
.TP
.B \-4, --dhcp-mac=set:<label>,<adresse MAC>
Associe une adresse matÃ©rielle (MAC) Ã  un label. L'adresse
matÃ©rielle peut inclure des jokers. Par exemple
.B --dhcp-mac=set:3com,01:34:23:*:*:*
permet de dÃ©finir le label "3com" pour n'importe quel hÃ´te dont l'adresse
matÃ©rielle coÃ¯ncide avec les critÃ¨res dÃ©finis.
.TP
.B --dhcp-circuitid=set:<label>,<identifiant de circuit>, --dhcp-remoteid=set:<label>,<identifiant distant>
Associe des options de relais DHCP issus de la RFC3046 Ã  des labels.
Cette information peut-Ãªtre fournie par des relais DHCP. L'identifiant
de circuit ou l'identifiant distant est normalement fourni sous la forme d'une
chaÃ®ne de valeurs hexadÃ©cimales sÃ©parÃ©es par des ":", mais il est Ã©galement
possible qu'elle le soit sous la forme d'une simple chaÃ®ne de caractÃ¨res. Si
l'identifiant de circuit ou d'agent correspond exactement Ã  celui fourni par le
relais DHCP, alors le label est apposÃ©.
.B dhcp-remoteid
est supportÃ© en IPv6 (mais non dhcp-circuitid).
.TP
.B --dhcp-subscrid=set:<label>,<identifiant d'abonnÃ©>
(IPv4 et IPv6) Associe des options de relais DHCP issues de la RFC3993 Ã  des
labels.
.TP
.B --dhcp-proxy[=<adresse ip>]......
(IPv4 seulement) Un agent relai DHCP normal est uniquement utilisÃ© pour faire
suivre les Ã©lÃ©ments initiaux de l'interaction avec le serveur DHCP. Une fois
que le client est configurÃ©, il communique directement avec le serveur. Cela
n'est pas souhaitable si le relais rajoute des informations supplÃ©mentaires
aux paquets DHCP, telles que celles utilisÃ©es dans
.B dhcp-circuitid
et
.B dhcp-remoteid.
Une implÃ©mentation complÃ¨te de relai peut utiliser l'option serverid-override
de la RFC 5107 afin de forcer le serveur DHCP Ã  utiliser le relai en temps que
proxy complet, de sorte que tous les paquets passent par le relai. Cette option
permet d'obtenir le mÃªme rÃ©sultat pour des relais ne supportant pas la RFC
5107. Fournie seule, elle manipule la valeur de server-id pour toutes les
interactions via des relais. Si une liste d'adresses IP est donnÃ©e, seules les
interactions avec les relais dont l'adresse est dans la liste seront affectÃ©es.
.TP
.B --dhcp-match=set:<label>,<numÃ©ro d'option>|option:<nom d'option>|vi-encap:<entreprise>[,<valeur>]
Si aucune valeur n'est spÃ©cifiÃ©e, associe le label si le client
envoie une option DHCP avec le numÃ©ro ou le nom spÃ©cifiÃ©. Lorsqu'une valeur est
fournie, positionne le label seulement dans le cas oÃ¹ l'option est fournie et
correspond Ã  la valeur. La valeur peut-Ãªtre de la forme "01:ff:*:02", auquel
cas le dÃ©but de l'option doit correspondre (en respectant les jokers). La
valeur peut aussi Ãªtre de la mÃªme forme que dans
.B dhcp-option
, auquel cas l'option est traitÃ©e comme un tableau de valeur, et un des
Ã©lÃ©ments doit correspondre, ainsi

--dhcp-match=set:efi-ia32,option:client-arch,6

spÃ©cifie le label "efi-ia32" si le numÃ©ro 6 apparaÃ®t dnas la liste
d'architectures envoyÃ© par le client au sein de l'option 93. (se rÃ©ferer
au RFC 4578 pour plus de dÃ©tails). Si la valeur est un chaine de caractÃ¨res,
celle-ci est recherchÃ©e (correspondance en temps que sous-chaÃ®ne).

Pour la forme particuliÃ¨re vi-encap:<numÃ©ro d'entreprise>, la comparaison se
fait avec les classes de vendeur "identifiant de vendeur" ("vendor-identifying
vendor classes") pour l'entreprise dont le numÃ©ro est fourni en option.
Veuillez vous rÃ©ferer Ã  la RFC 3925 pour plus de dÃ©tail.
.TP
.B --tag-if=set:<label>[,set:<label>[,tag:<label>[,tag:<label>]]]
Effectue une opÃ©ration boolÃ©enne sur les labels. Si tous les labels
apparaissant dans la liste tag:<label> sont positionnÃ©s, alors tous les
la de la liste "set:<labels>" sont positionnÃ©s (ou supprimÃ©s, dans le cas
oÃ¹ "tag:!<label>" utilisÃ©).
Si aucun tag:<label> n'est spÃ©cifiÃ©, alors tous les labels fournis par
set:<label> sont positionnÃ©s.
N'importe quel nombre de set: ou tag: peuvent Ãªtre fournis, et l'ordre est sans
importance.
Les lignes tag-if sont executÃ©es dans l'ordre, ce qui fait que si un label dans
tag:<label> est un label positionnÃ© par une rÃªgle
.B tag-if,
la ligne qui positionne le label doit prÃ©cÃ©der celle qui le teste.
.TP
.B \-J, --dhcp-ignore=tag:<label>[,tag:<label>]
Lorsque tous les labels fournis dans l'option sont prÃ©sents, ignorer l'hÃ´te et
ne pas donner de bail DHCP.
.TP
.B --dhcp-ignore-names[=tag:<label>[,tag:<label>]]
Lorsque tous les labels fournis dans l'option sont prÃ©sents, ignorer le
nom de machine fourni par l'hÃ´te. Il est Ã  noter que, Ã  la diffÃ©rence de
l'option "dhcp-ignore", il est permis de ne pas fournir de label.
Dans ce cas, les noms d'hÃ´tes fournis par les clients DHCP seront toujours
ignorÃ©s, et les noms d'hÃ´tes seront ajoutÃ©s au DNS en utilisant uniquement la
configuration dhcp-host de Dnsmasq, ainsi que le contenu des fichiers /etc/hosts
et /etc/ethers.
.TP
.B --dhcp-generate-names=tag:<label>[,tag:<label>]
(IPv4 seulement) GÃ©nÃ©rer un nom pour les clients DHCP qui autrement n'en aurait
pas, en utilisant l'adresse MAC sous sa forme hexadÃ©cimale, sÃ©parÃ©e par des
tirets.
Noter que si un hÃ´te fourni un nom, celui-ci sera utilisÃ© de prÃ©fÃ©rence au nom
autogÃ©nÃ©rÃ©, Ã  moins que
.B --dhcp-ignore-names 
ne soit positionnÃ©.
.TP
.B --dhcp-broadcast=[tag:<label>[,tag:<label>]]
(IPv4 seulement) Lorsque tous les labels fournis dans l'option sont prÃ©sents,
toujours utiliser le broadcast pour communiquer avec l'hÃ´te lorsque celui-ci
n'est pas configurÃ©. Il est possible de ne spÃ©cifier aucun label, auquel cas
cette option s'applique inconditionnellement. La plupart des clients DHCP
nÃ©cessitant une rÃ©ponse par le biais d'un broadcast activent une option dans
leur requÃªte, ce qui fait que cela se fait automatiquement, mais ce n'est pas
le cas de certains vieux clients BOOTP.
.TP
.B \-M, --dhcp-boot=[tag:<label>,]<nom de fichier>,[<nom de serveur>[,<adresse de serveur>|<nom du serveur tftp>]]
(IPv4 seulement) SpÃ©cifie les options BOOTP devant Ãªtre retournÃ©es par le
serveur DHCP. Le nom de serveur ainsi que l'adresse sont optionnels : s'ils
ne sont pas fournis, le nom est laissÃ© vide et l'adresse fournie est celle de
la machine sur laquelle s'exÃ©cute Dnsmasq. Si Dnsmasq founit un service TFTP (voir
.B --enable-tftp
), alors seul un nom de fichier est requis ici pour permettre un dÃ©marrage par
le rÃ©seau.
Si d'Ã©ventuels labels sont fournis, ils doivent coÃ¯ncider avec
ceux du client pour que cet Ã©lement de configuration lui soit envoyÃ©.
Une adresse de serveur TFTP peut Ãªtre spÃ©cifiÃ©e Ã  la place de l'adresse IP,
sous la forme d'un nom de domaine qui sera cherchÃ© dans le fichier /etc/hosts.
Ce nom peut Ãªtre associÃ© dans /etc/hosts avec plusieurs adresses IP, auquel cas
celles-ci seront utilisÃ©es tour Ã  tour (algorithme round-robin).
Cela peut-Ãªtre utiliser pour Ã©quilibrer la charge tftp sur plusieurs serveurs.
.TP
.B --dhcp-sequential-ip
Dnsmasq est conÃ§u pour choisir l'adresse IP des clients DHCP en utilisant
un hachage de l'adresse MAC du client. Cela permet en gÃ©nÃ©ral Ã  l'adresse
IP du client de rester stable au fil du temps, mÃªme lorsque le client laisse
expirer son bail DHCP de temps en temps. Dans ce mode de fonctionnement par
dÃ©faut, les adresses IP sont distribuÃ©es de faÃ§on pseudo-alÃ©atoire dans la
totalitÃ© de la plage d'adresses utilisable. Il existe des circonstances (par
exemples pour du dÃ©ploiement de serveur) oÃ¹ il est plus pratique d'allouer les
adresses IP de maniÃ¨re sÃ©quentielle, en commenÃ§ant par la plus petite adresse
disponible, et c'est ce mode de fonctionnement qui est permis par cette option.
Veuillez noter que dans ce mode sÃ©quentiel, les clients qui laissent expirer
leur bail ont beaucoup plus de chance de voir leur adresse IP changer, aussi
cette option ne devrait pas Ãªtre utilisÃ©e dans un cas gÃ©nÃ©ral.
.TP
.B --pxe-service=[tag:<label>,]<CSA>,<entrÃ©e de menu>[,<nom de fichier>|<type de service de dÃ©marrage>][,<adresse de serveur>|<nom de serveur>]
La plupart des ROMS de dÃ©marrage PXE ne permettent au systÃ¨me PXE que la simple
obtention d'une adresse IP, le tÃ©lÃ©chargement du fichier spÃ©cifiÃ© dans
.B dhcp-boot
et son exÃ©cution. Cependant, le systÃ¨me PXE est capable de fonctions bien plus
complexes pour peu que le serveur DHCP soit adaptÃ©.

Ceci spÃ©cifie l'option de dÃ©marrage qui apparaitra dans un menu de dÃ©marrage
PXE. <CSA> est le type du systÃ¨me client. Seuls des types de services valides
apparaitront dans un menu. Les types connus sont x86PC, PC98, IA64_EFI, Alpha,
Arc_x86, Intel_Lean_Client, IA32_EFI, BC_EFI, Xscale_EFI et X86-64_EFI;
D'autres types peuvent-Ãªtre spÃ©cifiÃ©s sous la forme d'une valeur entiÃ¨re. Le
paramÃ¨tre aprÃ¨s le texte correspondant Ã  l'entrÃ©e dans le menu peut Ãªtre un nom
de fichier, auquel cas Dnsmasq agit comme un serveur de dÃ©marrage et indique au
client PXE qu'il faut tÃ©lÃ©charger ce fichier via TFTP, soit depuis ce serveur
(l'option
.B enable-tftp 
doit Ãªtre spÃ©cifiÃ©e pour que cela marche), soit depuis un autre serveur TFTP
si une adresse ou un nom de serveur est fournie.
Veuillez noter que le suffixe de "couche" (en principe ".0") est fourni par PXE
et ne doit pas Ãªtre rajoutÃ© au nom de fichier. Si une valeur numÃ©rique entiÃ¨re
est fournir pour le type de dÃ©marrage, en remplacement du nom de fichier, le
client PXE devra chercher un service de dÃ©marrage de ce type sur le rÃ©seau.
Cette recherche peut Ãªtre faite via broadcast ou directement auprÃ¨s d'un
serveur si son adresse IP ou son nom sont fournis dans l'option.
Si aucun nom de fichier n'est donnÃ© ni aucune valeur de type de service de
dÃ©marrage n'est fournie (ou qu'une valeur de 0 est donnÃ©e pour le type de
service), alors l'entrÃ©e de menu provoque l'interruption du dÃ©marrage par
le rÃ©seau et la poursuite du dÃ©marrage sur un mÃ©dia local. L'adresse de serveur
peut Ãªtre donnÃ©e sous la forme de nom de domaine qui est recherchÃ© dans
/etc/hosts. Ce nom peut-Ãªtre associÃ© Ã  plusieurs adresses IP, qui dans ce cas
sont utilisÃ©es Ã  tour de rÃ´le (en "round-robin").
.TP
.B --pxe-prompt=[tag:<label>,]<invite>[,<dÃ©lai>]
Cette option permet d'afficher une invite Ã  la suite du dÃ©marrage PXE. Si un
dÃ©lai est fourni, alors la premiÃ¨re entrÃ©e du menu de dÃ©marrage sera
automatiquement exÃ©cutÃ©e aprÃ¨s ce dÃ©lai. Si le dÃ©lai vaut 0, alors la premiÃ¨re
entrÃ©e disponible sera exÃ©cutÃ©e immÃ©diatement. Si
.B pxe-prompt
est omis, le systÃ¨me attendra un choix de l'utilisateur s'il existe plusieurs
entrÃ©es dans le menu, ou dÃ©marrera immÃ©diatement dans le cas oÃ¹ il n'y a qu'une
seule entrÃ©e. Voir
.B pxe-service 
pour plus de dÃ©tails sur les entrÃ©es de menu.

Dnsmasq peut servir de "proxy-DHCP" PXE, dans le cas oÃ¹ un autre serveur DHCP
sur le rÃ©seau est responsable de l'allocation des adresses IP, auquel cas
Dnsmasq se contente de fournir les informations donnÃ©es dans les options
.B pxe-prompt
et
.B pxe-service
pour permettre le dÃ©marrage par le rÃ©seau. Ce mode est activÃ© en utilisant le
mot-clef
.B proxy
dans
.B dhcp-range.
.TP
.B \-X, --dhcp-lease-max=<nombre>
Limite Dnsmasq Ã  un maximum de <nombre> baux DHCP. Le dÃ©faut est de 1000. Cette
limite permet d'Ã©viter des attaques de dÃ©ni de service ("DoS") par des hÃ´tes
crÃ©ant des milliers de baux et utilisant beaucoup de mÃ©moire dans le processus
Dnsmasq.
.TP
.B \-K, --dhcp-authoritative
Doit Ãªtre spÃ©cifiÃ© lorsque dnsmasq est rÃ©ellement le seul serveur DHCP
sur le rÃ©seau. Pour DHCPv4, cela change le comportement par dÃ©faut qui est
celui d'un strict respect des RFC, afin que les requÃªtes DHCP pour des baux
inconnus par des hÃ´tes inconnus ne soient pas ignorÃ©es. Cela permet Ã  de
nouveaux hÃ´tes d'obtenir des baux sans tenir compte de fastidieuses
temporisations ("timeout"). Cela permet Ã©galement Ã  Dnsmasq de reconstruire
sa base de donnÃ©es contenant les baux sans que les clients n'aient besoin de
redemander un bail, si celle-ci est perdue.
Dans le cas de DHCPv6, cela positionne la prioritÃ© des rÃ©ponses Ã  255 (le
maximum) au lieu de 0 (le minimum).
.TP
.B --dhcp-alternate-port[=<port serveur>[,<port client>]]
(IPv4 seulement) Change les ports utilisÃ©s par dÃ©faut pour le DHCP. Si cette
option est donnÃ©e seule sans argument, alors change les ports utilisÃ©s pour le
DHCP de 67 et 68 respectivement Ã  1067 et 1068. Si un seul argument est donnÃ©, ce
numÃ©ro est utilisÃ© pour le port serveur et ce numÃ©ro plus 1 est utilisÃ© pour le
port client. Enfin, en fournissant deux numÃ©ros de ports, il est possible de
spÃ©cifier arbitrairement 2 ports Ã  la fois pour le serveur et pour le client DHCP.
.TP
.B \-3, --bootp-dynamic[=<identifiant de rÃ©seau>[,<identifiant de rÃ©seau>]]
(IPv4 seulement) Permet l'allocation dynamique d'adresses IP Ã  des clients BOOTP.
Utiliser cette option avec prÃ©caution, une adresse allouÃ©e Ã  un client BOOTP
Ã©tant perpÃ©tuelle, et de fait n'est plus disponibles pour d'autres hÃ´tes. Si
aucun argument n'est donnÃ©, alors cette option permet une allocation dynamique
dans tous les cas. Si des arguments sont spÃ©cifiÃ©s, alors l'allocation ne se
fait que lorsque tous les identifiants coÃ¯ncident. Il est possible de rÃ©peter
cette option avec plusieurs jeux d'arguments.
.TP
.B \-5, --no-ping
(IPv4 seulement) Par dÃ©faut, le serveur DHCP tente de s'assurer qu'une adresse
n'est pas utilisÃ©e avant de l'allouer Ã  un hÃ´te. Cela est fait en envoyant une
requÃªte ICMP de type "echo request" (aussi connue sous le nom de "ping") Ã 
l'adresse en question. Si le serveur obtient une rÃ©ponse, alors l'adresse doit
dÃ©jÃ  Ãªtre utilisÃ©e et une autre est essayÃ©e. Cette option permet de supprimer
cette vÃ©rification. A utiliser avec prÃ©caution.
.TP
.B --log-dhcp
Traces additionnelles pour le service DHCP : enregistre toutes les options
envoyÃ©es aux clients DHCP et les labels utilisÃ©s pour la
dÃ©termination de celles-ci.
.TP
.B --quiet-dhcp, --quiet-dhcp6, --quiet-ra
Supprime les logs des opÃ©rations de routine des protocoles concernÃ©s. Les
erreurs et les problÃ¨mes seront toujours enregistrÃ©s. L'option --log-dhcp
prends le pas sur --quiet-dhcp et quiet-dhcp6.
.TP
.B \-l, --dhcp-leasefile=<chemin de fichier>
Utilise le fichier dont le chemin est fourni pour stocker les informations de
baux DHCP.
.TP
.B --dhcp-duid=<ID d'entreprise>,<uid>
(IPv6 seulement) SpÃ©cifie le numÃ©ro d'UID de serveur persistant que le serveur
DHCPv6 doit utiliser. Cette option n'est normalement pas requise, Dnsmasq
crÃ©ant un DUID automatiquement lorsque cela est nÃ©cessaire. Lorsque cette
option est positionnÃ©e, elle fournit Ã  Dnsmasq les donnÃ©es nÃ©cessaires Ã  la
crÃ©ation d'un DUID de type DUID-EN. Veuillez noter qu'une fois crÃ©Ã©, le DUID
est stockÃ© dans la base des baux, aussi changer entre un DUID crÃ©Ã©
automatiquement et un DUID-EN et vice-versa impose de rÃ©initialiser la base de
baux. Le numÃ©ro d'ID d'entreprise est assignÃ© par l'IANA, et l'uid est une
chaine hexadÃ©cimale unique Ã  chaque serveur.
.TP
.B \-6 --dhcp-script=<chemin de fichier>
Lorsqu'un bail DHCP est crÃ©Ã©, qu'un ancien est supprimÃ©, ou qu'un transfert
TFTP est terminÃ©, le fichier dont le
chemin  est spÃ©cifiÃ© est exÃ©cutÃ©. Le <chemin de fichier> doit Ãªtre un chemin
absolu, aucune recherche n'est effectuÃ©e via la variable d'environnement PATH.
Les arguments fournis Ã  celui-ci sont soit
"add" ("ajouter"), "old" ("ancien") ou "del" ("supprimer"), suivi de l'adresse
MAC de l'hÃ´te (ou le DUID pour IPv6) puis l'adresse IP et le nom d'hÃ´te si
celui-ci est connu."add" signifie qu'un bail a Ã©tÃ© crÃ©Ã©, "del" signifie qu'il a
Ã©tÃ© supprimÃ©, "old" notifie que le bail existait au lancement de Dnsmasq, ou un
changement d'adresse MAC ou de nom d'hÃ´te pour un bail existant (ou, dans le cas
oÃ¹ leasefile-ro est spÃ©cifiÃ©, un changement de durÃ©e de bail ou d'identifiant
d'hÃ´te). Si l'adresse Mac est d'un type de rÃ©seau autre qu'ethernet, il est
nÃ©cessaire de la prÃ©ceder du type de rÃ©seau, par exemple "06-01:23:45:67:89:ab"
pour du token ring. Le processus est exÃ©cutÃ© en temps que super-utilisateur 
(si Dnsmasq a Ã©tÃ© lancÃ© en temps que "root"), mÃªme si Dnsmasq est configurÃ© 
pour changer son UID pour celle d'un utilisateur non-privilÃ©giÃ©.

L'environnement est hÃ©ritÃ© de celui de l'invocation du processus Dnsmasq,
auquel se rajoute quelques unes ou toutes les variables dÃ©crites ci-dessous :

Pour IPv4 et IPv6 :

DNSMASQ_DOMAIN si le nom de domaine pleinement qualifiÃ© de l'hÃ´te est connu, la
part relative au domaine y est stockÃ©e. (Notez que le nom d'hÃ´te transmis comme
argument au script n'est jamais pleinement qualifiÃ©).

Si le client fournit un nom d'hÃ´te, DNSMASQ_SUPPLIED_HOSTNAME.

Si le client fournit des classes d'utilisateur, DNSMASQ_USER_CLASS0 Ã 
DNSMASQ_USER_CLASSn.

Si Dnsmasq a Ã©tÃ© compilÃ© avec l'option HAVE_BROKEN_RTC ("horloge RTC
dÃ©fectueuse"), alors la durÃ©e du bail (en secondes) est stockÃ©e dans la
variable DNSMASQ_LEASE_LENGTH, sinon la date d'expiration du bail est toujours
stockÃ© dans la variable d'environnement DNSMASQ_LEASE_EXPIRES. Le nombre de
secondes avant expiration est toujours stockÃ© dans DNSMASQ_TIME_REMAINING.

Si un bail Ã©tait associÃ© Ã  un nom d'hÃ´te et
que celui-ci est supprimÃ©, un Ã©vÃªnement de type "old" est gÃ©nÃ©rÃ© avec le
nouveau statut du bail, c-Ã -d sans nom d'hÃ´te, et le nom initial est fourni
dans la variable d'environnement DNSMASQ_OLD_HOSTNAME.

La variable DNSMASQ_INTERFACE contient le nom de l'interface sur laquelle la
requÃªte est arrivÃ©e; ceci n'est pas renseignÃ© dans le cas des actions "old"
ayant lieu aprÃ¨s un redÃ©marrage de dnsmasq.

La variable DNSMASQ_RELAY_ADDRESS est renseignÃ©e si le client a utilisÃ© un
relai DHCP pour contacter Dnsmasq, si l'adresse IP du relai est connue.

DNSMASQ_TAGS contient tous les labels fournis pendant la transaction DHCP,
sÃ©parÃ©s par des espaces.

DNSMASQ_LOG_DHCP est positionnÃ© si
.B --log-dhcp
est activÃ©.

Pour IPv4 seulement :

DNSMASQ_CLIENT_ID, si l'hÃ´te a fourni un identifiant de client.

DNSMASQ_CIRCUIT_ID, DNSMASQ_SUBSCRIBER_ID, DNSMASQ_REMOTE_ID si un relai DHCP a
rajoutÃ© l'une de ces options.

Si le client fournit une information de classe de vendeur, DNSMASQ_VENDOR_CLASS.

Pour IPv6 seulement :

Si le client fournit une classe de vendeur (vendor-class), positionne
DNSMASQ_VENDOR_CLASS_ID avec comme contenu le numÃ©ro IANA de l'entreprise pour
la classe, et DNSMASQ_VENDOR_CLASS0..DNSMASQ_VENDOR_CLASSn pour les donnÃ©es.

DNSMASQ_SERVER_DUID contient le DUID du serveur : cette valeur est la mÃªme
pour chaque appel au script.

DNSMASQ_IAID contenant l'IAID pour le bail. Si le bail est une allocation
temporaire, cela est prÃ©fixÃ© par le caractÃ¨re 'T'.

DNSMASQ_MAC contient l'adresse MAC du client, si celle-ci est connue.

A noter que le nom d'hÃ´te fourni, la classe de vendeur ou les donnÃ©es de classe
d'utilisateur sont uniquement fournies pour les actions "add" ou l'action "old"
lorsqu'un hÃ´te reprend un bail existant, puisque ces informations ne sont pas
conservÃ©es dans la base de baux de dnsmasq.

Tous les descripteurs de fichiers sont fermÃ©s, sauf stdin, stdout et stderr qui
sont ouverts sur /dev/null (sauf en mode dÃ©verminage).

Le script n'est pas lancÃ© de maniÃ¨re concurrente : au plus une instance du
script est executÃ©e Ã  la fois (dnsmasq attends qu'une instance de script se
termine avant de lancer la suivante). Les changements dans la base des baux
nÃ©cessitant le lancement du script sont placÃ© en attente dans une queue jusqu'Ã 
terminaison d'une instance du script en cours. Si cette mise en queue fait que
plusieurs changements d'Ã©tats apparaissent pour un bail donnÃ© avant que le
script puisse Ãªtre lancÃ©, alors les Ã©tats les plus anciens sont supprimÃ©s et
lorsque le script sera finalement lancÃ©, ce sera avec l'Ã©tat courant du bail.

Au dÃ©marrage de Dnsmasq, le script sera invoquÃ© pour chacun des baux existants
dans le fichier des baux. Le script sera lancÃ© avec l'action "del" pour les
baux expirÃ©s, et "old" pour les autres. Lorsque Dnsmasq reÃ§oit un signal HUP,
le script sera invoquÃ© avec une action "old" pour tous les baux existants.

Il existe deux autres actions pouvant apparaÃ®tre comme argument au script :
"init" et "tftp". D'autres sont susceptibles d'Ãªtre rajoutÃ©es dans le futur,
aussi les scripts devraient-Ãªtre Ã©crits de sorte Ã  ignorer les actions
inconnues. "init" est dÃ©crite ci-dessous dans
.B --leasefile-ro.
L'action "tftp" est invoquÃ©e lorsqu'un transfert de fichier TFTP s'est
terminÃ©. Ses arguments sont la taille du fichier en octets, l'adresse Ã 
laquelle le fichier a Ã©tÃ© envoyÃ©, ainsi que le chemin complet du fichier.

.TP
.B --dhcp-luascript=<chemin>
SpÃ©cifie un script Ã©crit en Lua, devant Ãªtre exÃ©cutÃ© lorsque des baux sont
crÃ©Ã©s, dÃ©truits ou modifiÃ©s. Pour utiliser cette option, dnsmasq doit Ãªtre
compilÃ© avec avec le support de Lua. L'interprÃ©teur Lua est initialisÃ© une
seule fois, lorsque dnsmasq dÃ©marre, ce qui fait que les variables globales
persistent entre les Ã©vÃªnements liÃ©s aux baux. Le code Lua doit dÃ©finir une
fonction
.B lease
et peut fournir des fonctions
.B init
et
.B shutdown
qui sont appellÃ©es, sans arguments, lorsque dnsmasq dÃ©marre ou s'arrÃªte.
Il peut Ã©galement fournir une fonction
.B tftp.

La fonction
.B lease
reÃ§oit les informations dÃ©taillÃ©es dans
.B --dhcp-script. 
Il reÃ§oit deux arguments. Le premier spÃ©cifie l'action, qui est une chaÃ®ne de
caractÃ¨res contenant les valeurs "add" (ajout), "old" (rÃ©activation d'un bail
existant) ou "del" (suppression). Le deuxiÃ¨me est une table contenant des
paires de valeurs de labels. Les labels correspondent pour l'essentiel aux
valeurs d'environnement dÃ©taillÃ©es ci-dessus, ainsi le label "domain" (domaine)
contient les mÃªmes donnÃ©es que la variable d'environnement DNSMASQ_DOMAIN. Il
existe quelques labels supplÃ©mentaires contenant les donnÃ©es fournies comme
arguments Ã 
.B --dhcp-script. 
Ces labels sont
.B mac_address, ip_address
(pour respectivement l'adresse MAC et l'adresse IP)
et
.B hostname
(le nom d'hÃ´te) dans le cas d'IPv4, et
.B client_duid, ip_address
(valeur DUID du client et adresse IP respectivement)
ainsi que
.B hostname
(le nom d'hÃ´te) dans le cas d'IPv6.

La fonction
.B tftp
est appelÃ©e de la mÃªme faÃ§on que la fonction "lease", et la table contient les
labels
.B destination_address,
.B file_name
et
.B file_size
(respectivement "adresse de destination", "nom de fichier" et "taille de fichier").
.TP
.B --dhcp-scriptuser
SpÃ©cifie l'utilisateur sous lequel le script shell lease-change ou le script
doivent Ãªtre exÃ©cutÃ©s. La valeur par dÃ©faut correspond Ã  l'utilisateur root
mais peut-Ãªtre changÃ©e par le biais de cette option.
.TP
.B \-9, --leasefile-ro
Supprimer complÃ¨tement l'usage du fichier servant de base de donnÃ©e pour les
baux DHCP. Le fichier ne sera ni crÃ©Ã©, ni lu, ni Ã©crit. Change la faÃ§on dont le
script de changement d'Ã©tat de bail est lancÃ© (si celui-ci est fourni par le
biais de l'option
.B --dhcp-script
), de sorte que la base de donnÃ©es de baux puisse
Ãªtre complÃ¨tement gÃ©rÃ©e par le script sur un stockage externe. En addition aux
actions dÃ©crites dans 
.B  --dhcp-script,
le script de changement d'Ã©tat de bail est appellÃ© une fois, au lancement de
Dnsmasq, avec pour seul argument "init". Lorsqu'appellÃ© de la sorte, le script
doit fournir l'Ã©tat de la base de baux, dans le format de fichier de baux de
Dnsmasq, sur sa sortie standard (stdout) et retourner un code de retour de 0.
Positionner cette option provoque Ã©galement une invocation du script de
changement d'Ã©tat de bail Ã  chaque changement de l'identifiant de client, de
longueur de bail ou de date d'expiration.
.TP
.B --bridge-interface=<interface>,<alias>[,<alias>]
Traiter les requÃªtes DHCP arrivant sur n'importe laquelle des interfaces <alias>
comme si elles arrivaient de l'interface <interface>. Cette option est
nÃ©cessaire lors de l'utilisation de pont ethernet "ancien mode" sur plate-forme
BSD, puisque dans ce cas les paquets arrivent sur des interfaces "tap" n'ont
pas d'adresse IP.  Chaque <alias> peut finir avec un simple '*' joker.
.TP
.B \-s, --domain=<domaine>[,<gamme d'adresses>[,local]]
SpÃ©cifie le domaine du serveur DHCP. Le domaine peut Ãªtre donnÃ© de maniÃ¨re
inconditionnelle (sans spÃ©cifier de gamme d'adresses IP) ou pour des gammes
d'adresses IP limitÃ©es. Cela a deux effets; tout d'abord, le
serveur DHCP retourne le domaine Ã  tous les hÃ´tes le demandant, deuxiÃ¨mement,
cela spÃ©cifie le domaine valide pour les hÃ´tes DHCP configurÃ©s. Le but de cela
est de contraindre les noms d'hÃ´te afin qu'aucun hÃ´te sur le LAN ne puisse
fournir via DHCP un nom tel que par exemple "microsoft.com" et capturer du
trafic de maniÃ¨re illÃ©gitime. Si aucun nom de domaine n'est spÃ©cifiÃ©, alors
les noms d'hÃ´tes avec un nom de domaine (c-Ã -d un point dans le nom) seront
interdits et enregistrÃ©s dans le journal (logs). Si un suffixe est fourni, alors
les noms d'hÃ´tes possÃ©dant un domaine sont autorisÃ©s, pour peu que le nom de
domaine coÃ¯ncide avec le nom fourni. De plus, si un suffixe est fourni, alors
les noms d'hÃ´tes ne possÃ©dant pas de nom de domain se voient rajouter le
suffixe fourni dans l'option
.B --domain.
Ainsi, sur mon rÃ©seau, je peux configurer
.B --domain=thekelleys.org.uk
et avoir une machine dont le nom DHCP serait "laptop". L'adresse IP de cette
machine sera disponible Ã  la fois pour "laptop" et "laptop.thekelleys.org.uk".
Si la valeur fournie pour <domaine> est "#", alors le nom de domaine est
positionnÃ© Ã  la premiÃ¨re valeur de la directive "search" du fichier
/etc/resolv.conf (ou Ã©quivalent).

La gamme d'adresses peut Ãªtre de la forme
<adresse ip>,<adresse ip> ou <adresse ip>/<masque de rÃ©seau> voire une simple
<adresse ip>. Voir
.B --dhcp-fqdn
qui peut changer le comportement de dnsmasq relatif aux domaines.

Si la gamme d'adresse est fournie sous la forme
<adresse ip>/<taille de rÃ©seau>, alors le drapeau "local" peut-Ãªtre rajoutÃ©
qui a pour effect d'ajouter --local-declarations aux requÃªtes DNS directes et
inverses. C-Ã -d
.B --domain=thekelleys.org.uk,192.168.0.0/24,local
est identique Ã 
.B --domain=thekelleys.org.uk,192.168.0.0/24
--local=/thekelleys.org.uk/ --local=/0.168.192.in-addr.arpa/
La taille de rÃ©seau doit-Ãªtre de 8, 16 ou 24 pour Ãªtre valide.
.TP
.B --dhcp-fqdn
Dans le mode par dÃ©faut, dnsmasq insÃ¨re les noms non-qualifiÃ©s des clients
DHCP dans le DNS. Pour cette raison, les noms doivent Ãªtre uniques, mÃªme si
deux clients ayant le mÃªme nom sont dans deux domaines diffÃ©rents. Si un
deuxiÃ¨me client DHCP apparaÃ®t ayant le mÃªme nom qu'un client dÃ©jÃ  existant,
ce nom est transfÃ©rÃ© au nouveau client. Si
.B --dhcp-fqdn
est spÃ©cifiÃ©, ce comportement change : les noms non qualifiÃ©s ne sont plus
rajoutÃ©s dans le DNS, seuls les noms qualifiÃ©s le sont. Deux clients DHCP
avec le mÃªme nom peuvent tous les deux garder le nom, pour peu que la partie
relative au domaine soit diffÃ©rente (c-Ã -d que les noms pleinements qualifiÃ©s
diffÃ¨rent). Pour d'assurer que tous les noms ont une partie domaine, il doit-y
avoir au moins un
.B --domain
sans gamme d'adresses de spÃ©cifiÃ© lorsque l'option
.B --dhcp-fqdn 
est configurÃ©e.
.TP
.B --dhcp-client-update
Normalement, lorsque dnsmasq fournit un bail DHCP, il positionne un label
dans l'option FQDN pour indiquer au client qu'il ne doit pas tenter de faire
une mise Ã  jour DDNS avec son nom et son adresse IP. Ceci parce que la paire
Nom-IP est rajoutÃ©e automatiquement dans la partie DNS de dnsmasq. Cette option
inhibe ce comportement ce qui est utile, par exemple, pour permettre aux clients
Windows de la mise Ã  jour de serveurs Active Directory. Voir la RFC 4702 pour
plus de dÃ©tails.
.TP
.B --enable-ra
Active la fonctionalitÃ© d'annonces routeurs IPv6 ("IPv6 Router Advertisement").
DHCPv6 ne gÃ¨re pas la configuration complÃ¨te du rÃ©seau de la mÃªme faÃ§on que
DHCPv4. La dÃ©couverte de routeurs et la dÃ©couverte (Ã©ventuelle) de prÃ©fixes pour
la crÃ©ation autonome d'adresse sont gÃ©rÃ©es par un protocole diffÃ©rent.
Lorsque DHCP est utilisÃ©, seul un sous-ensemble de tout ceci est nÃ©cessaire et
dnsmasq est Ã  mÃªme de le gÃ©rer, en utilisant la configuration DHCP prÃ©sente pour
fournir la majoritÃ© des donnÃ©es. Lorsque les annonces routeurs (RA pour "Router
Advertisement") sont activÃ©es, dnsmasq va annoncer un prÃ©fixe pour chaque
dhcp-range et, par dÃ©faut, fournir comme valeur de routeur et de DNS rÃ©cursif
la valeur d'adresse link-local appropriÃ©e parmi celles de la machine sur
laquelle tourne dnsmasq.
Par dÃ©faut, les bits "managed address" sont positionnÃ©s, et le bit "use SLAAC"
("utiliser SLAAC") est rÃ©initialisÃ©. Cela peut-Ãªtre changÃ© pour des
sous-rÃ©seaux donnÃ©s par le biais du mot clef de mode dÃ©cris dans
.B --dhcp-range.
Les paramÃ¨tres DNS du RFC6106 sont inclus dans les annonces. Par dÃ©faut,
l'adresse link-local appropriÃ©e parmi celles de la machine sur laquelle tourne
dnsmasq est spÃ©cifiÃ©e comme DNS rÃ©cursif. Si elles sont fournies, les
options dns-server et domain-search sont utilisÃ©es respectivement pour RDNSS et
DNSSL.
.TP
.B --ra-param=<interface>,[high|low],[[<intervalle d'annonce routeur>],<durÃ©e de vie route>]
Configure pour une interface donnÃ©e des valeurs pour les annonces routeurs
diffÃ©rentes des valeurs par dÃ©faut. La valeur par dÃ©faut du champ prioritÃ©
pour le routeur peut-Ãªtre changÃ©e de "medium" (moyen) Ã  "high" (haute) ou
"low" (basse). Par exemple :
.B --ra-param=eth0,high.
Un intervalle (en secondes) entre les annonces routeur peut-Ãªtre fourni par :
.B --ra-param=eth0,60.
La durÃ©e de vie de la route peut-Ãªtre changÃ©e ou mise Ã  zÃ©ro, auquel cas 
le routeur peut annoncer les prÃ©fixes mais pas de route :
.B --ra-parm=eth0,0,0
(une valeur de zÃ©ro pour l'intervalle signifie qu'il garde la valeur par dÃ©faut).
Ces trois paramÃ¨tres peuvent-Ãªtre configurÃ©s en une fois :
.B --ra-param=low,60,1200
La valeur pour l'interface peut inclure un caractÃ¨re joker.
.TP
.B --enable-tftp[=<interface>[,<interface>]]
Active la fonction serveur TFTP. Celui-ci est de maniÃ¨re dÃ©libÃ©rÃ©e limitÃ© aux
fonctions nÃ©cessaires au dÃ©marrage par le rÃ©seau ("net-boot") d'un client. Seul
un accÃ¨s en lecture est possible; les extensions tsize et blksize sont supportÃ©es
(tsize est seulement supportÃ© en mode octet). Sans argument optionel, le service
TFTP est fourni sur les mÃªmes interfaces que le service DHCP. Si une liste
d'interfaces est fournie, cela dÃ©finit les interfaces sur lesquelles le
service TFTP sera activÃ©.
.TP
.B --tftp-root=<rÃ©pertoire>[,<interface>]
Les fichiers Ã  fournir dans les transferts TFTP seront cherchÃ©s en prenant le
rÃ©pertoire fourni comme racine. Lorsque cela est fourni, les chemins TFTP
incluant ".." sont rejetÃ©s, afin d'Ã©viter que les clients ne puissent sortir de
la racine spÃ©cifiÃ©e. Les chemins absolus (commenÃ§ant par "/") sont autorisÃ©s,
mais ils doivent Ãªtre Ã  la racine TFTP fournie. Si l'option interface est
spÃ©cifiÃ©e, le rÃ©pertoire n'est utilisÃ© que pour les requÃªtes TFTP reÃ§ues sur
cette interface.
.TP
.B --tftp-unique-root
Ajouter l'adresse IP du client TFTP en temps qu'Ã©lÃ©ment de chemin, Ã  la suite
de la racine tftp (adresse sous forme de 4 chiffres sÃ©parÃ©s par des points).
Uniquement valable si une racine TFTP est spÃ©cifiÃ©e et si le rÃ©pertoire
correspond existe. Ainsi, si la valeur pour tftp-root est "/tftp" et que le
client d'adresse IP 1.2.3.4 requiert le fichier "monfichier", alors le chemin
effective rÃ©sultant sera "/tftp/1.2.3.4/monfichier" si /tftp/1.2.3.4 existe, ou
"/tftp/monfichier" dans le cas contraire.
.TP
.B --tftp-secure
Active le mode TFTP sÃ©curisÃ© : sans cela, tout fichier lisible
par Dnsmasq est disponible via TFTP (les rÃ¨gles de contrÃ´le d'accÃ¨s unix
habituelles s'appliquent). Lorsque l'option
.B --tftp-secure
est spÃ©cifiÃ©e, seuls les fichiers possÃ©dÃ©s par l'utilisateur sous lequel tourne
le processus Dnsmasq sont accessibles. Si Dnsmasq est exÃ©cutÃ© en temps que
super-utilisateur ("root"), des rÃ¨gles diffÃ©rentes s'appliquent :
.B --tftp-secure
n'a aucun effet, mais seuls les fichiers ayant un droit de lecture pour tout le
monde sont accessibles. Il n'est pas recommandÃ© d'exÃ©cuter Dnsmasq sous
l'utilisateur "root" lorsque le service TFTP est activÃ©, et il est formellement
dÃ©conseillÃ© de le faire sans fournir l'option
.B --tftp-root.
Sans cela, en effet, l'accÃ¨s de tous les fichiers du serveur pour lequel le
droit de lecture pour tout le monde est positionnÃ© ("world-readable") devient
possible par n'importe quel hÃ´te sur le rÃ©seau.
.TP
.B --tftp-lowercase
Converti les noms de fichiers des requÃªtes TFTP en minuscules. Cela est utile
pour les requÃªtes effectuÃ©es depuis les machines Windows, dont les systÃ¨mes
de fichiers sont insensibles Ã  la casse et pour lesquels la dÃ©termination
de la casse est parfois un peu alÃ©atoire. A noter que le serveur tftp de
dnsmasq converti systÃ©matiquement les "\\" en "/" dans les noms de fichiers.
.TP
.B --tftp-max=<connexions>
DÃ©finit le nombre maximum de connexions TFTP simultanÃ©es autorisÃ©es. La valeur
par dÃ©faut est de 50. Lorsqu'un grand nombre de connexions TFTP est spÃ©cifiÃ©,
il se peut que la limite de nombre de descripteurs de fichiers par processus
soit atteinte. Dnsmasq nÃ©cessite quelques descripteurs de fichiers, ainsi qu'un
descripteur de fichier pour chaque connexion TFTP simultanÃ©e et pour chacun des
fichiers devant Ãªtre fournis. De fait, servir le mÃªme fichier Ã  n clients ne
nÃ©cessitera qu'environ n + 10 descripteurs de fichiers, alors que fournir des
fichiers tous diffÃ©rents Ã  n clients utilisera environ (2*n) + 10 descripteurs.
Si elle est donnÃ©e, l'option 
.B --tftp-port-range
peut affecter le nombre maximum de connexions concurrentes.
.TP
.B --tftp-no-blocksize
EmpÃªche le serveur TFTP de nÃ©gocier l'option "blocksize" (taille de bloc) avec
les clients. Certains clients buggÃ©s spÃ©cifient cette option mais se comportent
ensuite de maniÃ¨re incorrecte si celle-ci est accordÃ©e.
.TP
.B --tftp-port-range=<dÃ©but>,<fin>
Un serveur TFTP Ã©coute sur le port prÃ©dÃ©fini 69 ("well-known port") pour
l'initiation de la connexion, mais utilise Ã©galement un port dynamiquement
allouÃ© pour chaque connexion. Normalement, ces ports sont allouÃ©s par
le systÃ¨me d'exploitation, mais cette option permet de spÃ©cifier une gamme
de ports Ã  utiliser pour les transferts TFTP. Cela peut-Ãªtre utile si
TFTP doit traverser un dispositif garde-barriÃ¨re ("firewall"). La valeur
de dÃ©but pour la plage de port ne peut-Ãªtre infÃ©rieure Ã  1025 sauf si
dnsmasq tourne en temps que super-utilisateur ("root"). Le nombre de
connexions TFTP concurrentes est limitÃ©e par la taille de la gamme de
ports ainsi spÃ©cifiÃ©e.
.TP
.B --tftp-port-range=<dÃ©but>,<fin>
Un serveur TFTP Ã©coute sur un numÃ©ro de port bien connu (69) pour l'initiation
de la connexion, et alloue dynamiquement un port pour chaque connexion. Ces
numÃ©ros de ports sont en principe allouÃ©s par le systÃ¨me d'exploitation, mais
cette option permet de spÃ©cifier une gamme de ports Ã  utiliser pour les
transferts TFTP. Cela peut-Ãªtre utile lorsque ceux-ci doivent traverser un
dispositif garde-barriÃ¨re ("firewall"). Le dÃ©but de la plage ne peut-Ãªtre
infÃ©rieur Ã  1024 Ã  moins que Dnsmasq ne fonctionne en temps que
super-utilisateur ("root"). Le nombre maximal de connexions TFTP concurrentes
est limitÃ©e par la taille de la plage de ports ainsi dÃ©finie. 
.TP
.B \-C, --conf-file=<fichier>
SpÃ©cifie un fichier de configuration diffÃ©rent. L'option "conf-file" est
Ã©galement autorisÃ©e dans des fichiers de configuration, ce qui permet
l'inclusion de multiples fichiers de configuration. L'utilisation de "-" comme
nom de fichier permet la lecture par dnsmasq de sa configuration sur l'entrÃ©e standard
stdin.
.TP
.B \-7, --conf-dir=<rÃ©pertoire>[,<extension de fichier>...]
Lis tous les fichiers du rÃ©pertoire spÃ©cifiÃ© et les traite comme des fichiers de
configuration. Si des extensions sont donnÃ©es, tout fichier finissant par ces
extensions seront ignorÃ©s. Tout fichier dont le nom se termine en ~ ou commence
par ., ainsi que ceux commenÃ§ant ou se terminant par # seront systÃ©matiquement
ignorÃ©s.
Cette option peut Ãªtre donnÃ©e en ligne de commande ou dans un fichier de
configuration.
.SH FICHIER DE CONFIGURATION
Au dÃ©marrage, Dnsmasq lis
.I /etc/dnsmasq.conf,
si ce fichier existe. (Sur FreeBSD, ce fichier est
.I /usr/local/etc/dnsmasq.conf
) (voir cependant les options 
.B \-C
et
.B \-7
). Le format de ce fichier consiste en une option par ligne, exactement comme
les options longues dÃ©taillÃ©es dans la section OPTIONS, mais sans Ãªtre prÃ©cÃ©dÃ©es
par "--". Les lignes commenÃ§ant par # sont des commentaires et sont ignorÃ©es.
Pour les options qui ne peuvent-Ãªtre spÃ©cifiÃ©es qu'une seule fois, celle du
fichier de configuration prends le pas sur celle fournie en ligne de commande.
Il est possible d'utiliser des guillemets afin d'Ã©viter que les ",",":","." et
"#" ne soit interprÃªtÃ©s, et il est possible d'utiliser les sÃ©quences
d'Ã©chappement suivantes : \\\\ \\" \\t \\e \\b \\r et \\n. Elles correspondent
respectivement Ã  la barre oblique descendante ("anti-slash"), guillemets doubles,
tabulation, caractÃ¨re d'Ã©chappement ("escape"), suppression ("backspace"), retour ("return") et
nouvelle ligne ("newline").
.SH NOTES
A la rÃ©ception d'un signal SIGHUP,
.B Dnsmasq
vide son cache et recharge les fichiers
.I /etc/hosts
et
.I /etc/ethers 
ainsi que tout autre fichier spÃ©cifiÃ© par les options
.B --dhcp-hostsfile
,
.B --dhcp-optsfile
ou
.B --addn-hosts.
Le script de changement de bail est appellÃ© pour chaque bail DHCP existant. Si
l'option
.B --no-poll
est positionnÃ©e, alors le fichier
.I /etc/resolv.conf
est Ã©galement rechargÃ©.
SIGHUP ne provoque PAS de rechargement du fichier de configuration.
.PP
A la rÃ©ception d'un signal SIGUSR1,
.B Dnsmasq 
Ã©crit des statistiques dans les traces systÃ¨me. Les informations fournies sont :
la taille du cache, le nombre de noms ayant Ã©tÃ© supprimÃ©s du cache avant
expiration afin de faire de la place pour les nouveaux noms, ainsi que le nombre
total d'entrÃ©es ayant Ã©tÃ© insÃ©rÃ©es dans le cache. Pour chaque serveur amont, il fournit
le nomnbre de requÃªtes transmises ainsi que le nombre de requÃªtes ayant rÃ©sultÃ© par une
erreur. Lorsque Dnsmasq a Ã©tÃ© lancÃ© via
.B --no-daemon
ou lorsque la traÃ§abilitÃ© maximale a Ã©tÃ© activÃ©e (
.B -q
), la totalitÃ© du contenu du
cache est de surcroÃ®t fournie.
.PP 
A la rÃ©ception d'un signal SIGUSR2 et lorsqu'il enregistre directement ses
traces dans un fichier (voir
.B --log-facility
), alors 
.B Dnsmasq
ferme et re-rouvre le fichier de traces. Il faut noter que pendant cette
opÃ©ration Dnsmasq ne s'exÃ©cute pas en temps que "root". Lorsqu'il crÃ©Ã© un
fichier de traces pour la premiÃ¨re fois, Dnsmasq change le propriÃ©taire du
fichier afin de le faire appartenir Ã  l'utilisateur non "root" sous lequel
Dnsmasq s'exÃ©cute. Le logiciel de rotation de fichiers de trace logrotate doit
Ãªtre configurÃ© pour crÃ©er un nouveau fichier avec un propriÃ©taire identique au
fichier existant avant d'envoyer le signal SIGUSR2. Si une requÃªte DNS TCP est
en cours, l'ancien fichier de traces reste ouvert dans le processus fils qui
traite la requÃªte TCP et il peut y Ãªtre Ã©crit. Il existe cependant une limite
de 150 secondes aprÃ¨s laquelle tous les processus traitant des requÃªtes TCP
expirent : pour cette raison, il est prÃ©fÃ©rable de ne pas configurer la
compression des fichiers de traces venant juste de faire l'objet d'une rotation.
Dans le cas de l'utilisation du logiciel logrotate, les options requises sont
.B create 
et
.B delaycompress.
 
.PP
Dnsmasq est un logiciel de transmission de requÃªtes DNS : il n'est pas capable
d'effectuer une rÃ©solution de nom rÃ©cursive en partant des serveurs DNS racine,
mais transmet de telles requÃªtes Ã  un serveur DNS amont capable de telles
recherches rÃ©cursives, ce qui est typiquement le cas d'un serveur DNS de FAI.
Par dÃ©faut, Dnsmasq lis
.I /etc/resolv.conf
pour dÃ©couvrir les adresses IP des serveurs DNS amonts Ã  utiliser, puisque cette
information est en gÃ©nÃ©ral stockÃ©e Ã  cet endroit. A moins que l'option
.B --no-poll
ne soit utilisÃ©e,
.B Dnsmasq
vÃ©rifie la date de modification du fichier
.I /etc/resolv.conf
(ou l'Ã©quivalent si 
.B \--resolv-file 
est utilisÃ©), et le relis lorsqu'il change. Cela permet de dÃ©finir les serveurs
DNS amont de maniÃ¨re dynamique lorsque PPP ou DHCP sont utilisÃ©s, puisque ces
protocoles fournissent cette information.
L'absence du fichier
.I /etc/resolv.conf
ne conduit pas Ã  une erreur, puisqu'il peut trÃ¨s bien ne pas Ãªtre crÃ©Ã© avant
qu'une connexion PPP ne soit Ã©tablie. Dans ce cas, Dnsmasq vÃ©rifie rÃ©guliÃ¨rement
pour voir si un fichier
.I /etc/resolv.conf 
est crÃ©Ã©. Dnsmasq peut Ãªtre configurÃ© pour lire plus d'un fichier resolv.conf.
Cela est utile sur un ordinateur portable oÃ¹ PPP et DHCP peuvent-Ãªtre utilisÃ©s :
Dnsmasq peut alors Ãªtre configurÃ© pour lire Ã  la fois
.I /etc/ppp/resolv.conf 
et
.I /etc/dhcpc/resolv.conf 
et utilisera le contenu du fichier ayant changÃ© en dernier, ce qui permet de
passer automatiquement de serveurs DNS Ã  d'autres.
.PP
Les serveurs amonts peuvent aussi Ãªtre spÃ©cifiÃ©s sur la ligne de commande ou
dans un fichier de configuration. Ces spÃ©cifications de serveurs peuvent
Ã©ventuellement se voir adjoindre d'un nom de domaine qui prÃ©cise Ã  Dnsmasq quel
serveur utiliser pour trouver les noms d'un domaine donnÃ©.
.PP
Pour configurer Dnsmasq afin qu'il se comporte comme un cache pour la machine
sur laquelle il tourne, mettre "nameserver 127.0.0.1" dans le fichier
.I /etc/resolv.conf
afin de forcer les processus locaux Ã  envoyer leurs requÃªtes Ã  Dnsmasq. Ensuite,
spÃ©cifier les serveurs DNS amont soit en les fournissant directement Ã  Dnsmasq
via l'option
.B \--server
ou alors en mettant leurs adresses dans un autre fichier, par exemple
.I /etc/resolv.dnsmasq
et en lanÃ§ant Dnsmasq avec l'option
.B \-r /etc/resolv.dnsmasq.
Cette deuxiÃ¨me technique permet la mise-Ã -jour dynamique des addresses de
serveurs DNS amont par le biais de PPP ou DHCP.
.PP
Les adresses dans /etc/hosts prennent le dessus sur celles fournies par le
serveur DNS amont, ainsi "macompagnie.com 1.2.3.4" dans /etc/hosts assure que
les requÃªtes pour "macompagnie.com" retourneront toujours 1.2.3.4, mÃªme si une
requÃªte au serveur DNS amont retournerait une adresse diffÃ©rente. Il y a une
exception Ã  ceci : si le DNS amont contient un CNAME qui pointe vers un nom
prÃ©sent dans /etc/hosts, alors la recherche du CNAME via Dnsmasq fournira
l'adresse DNS amont. Pour contourner cela, il suffit de mettre l'entrÃ©e
correspondant au CNAME dans /etc/hosts.
.PP
le systÃ¨me de label fonctionne comme suit : pour chaque requÃªte DHCP, dnsmasq
associe un ensemble de labels obtenus Ã  partir des lignes de la configuration
incluant set:<label>, y compris un pour la plage d'adresse (
.B dhcp-range
) utilisÃ©e pour allouer l'adresse, un pour chaque entrÃ©e
.B dhcp-host
associÃ©e (auquel est rajoutÃ© le mot-clef "known" si une entrÃ©e dhcp-host
coÃ¯ncide).

Le label "bootp" est associÃ© aux requÃªtes BOOTP, un label dont le nom est le
nom de l'interface sur laquelle la requÃªte est arrivÃ©e.

Pour les lignes de configuration comportant des Ã©lÃ©ments tag:<label>,
seules seront valides celles pour lesquels tous les labels correspondants
seront prÃ©sents. C'est typiquement le cas des lignes dhcp-options.
Un
.B dhcp-option 
possÃ©dant des labels sera utilisÃ© de prÃ©fÃ©rence Ã  un
.B dhcp-option 
sans label, pour peu que _tous_ les labels positionnÃ©s correspondent Ã  l'ensemble
de labels dÃ©crit plus haut.
Le prÃ©fixe '!' sur un label est un indicateur de nÃ©gation, ainsi
.B --dhcp=option=tag:!purple,3,1.2.3.4
n'envoie l'option que lorsque le label "purple" n'est pas dans la liste de
labels dÃ©finis pour l'hÃ´te considÃ©rÃ©. (dans le cas de l'utilisation dans une
ligne de commande au lieu d'un fichier de configuration, ne pas oublier
d'Ã©chapper le caractÃ¨re !, qui est un mÃ©ta-caractÃ¨re d'interprÃ©teur de commande
shell).

Lors de la sÃ©lection d'une option, une Ã©tiquette spÃ©cifiÃ©e par dhcp-range
passe aprÃ¨s les autres Ã©tiquettes, ce qui permet de facilement remplacer des
option gÃ©nÃ©riques pour des hÃ´tes spÃ©cifiques, ainsi :
.B dhcp-range=set:interface1,......
.B dhcp-host=set:monhote,.....
.B dhcp-option=tag:interface1,option:nis-domain,"domaine1"
.B dhcp-option=tag:monhote,option:nis-domain,"domaine2"
va positionner l'option NIS-domain Ã  domaine1 pour les hÃ´tes dans la plage
d'adresse, sauf pour monhote pour lequel cette valeur sera domaine2.

.PP
Veuillez noter que pour
.B dhcp-range
, les Ã©lÃ©ments tag:<label> et set:<label> sont tous les deux autorisÃ©s
pour sÃ©lectionner la plage Ã  utiliser selon, par exemple, le dhcp-host,
et pour affecter l'option envoyÃ©e, sur la base de la plage sÃ©lectionnÃ©e.

Ce systÃ¨me a Ã©voluÃ© d'un systÃ¨me plus ancien et aux possibilitÃ©s plus limitÃ©es,
et pour des raisons de compatibilitÃ© "net:" peut Ãªtre utilisÃ© Ã  la place de
"tag:" et "set:" peut-Ãªtre omis (Ã  l'exception de
.B dhcp-host,
oÃ¹ "net:" peut-Ãªtre utilisÃ© Ã  la place de "set:"). Pour les mÃªmes raisons, '#'
peut-Ãªtre utilisÃ© Ã  la place de '!' pour indiquer la nÃ©gation.
.PP 
Le serveur DHCP intÃ©grÃ© dans Dnsmasq fonctionne Ã©galement en temps que serveur
BOOTP, pour peu que l'adresse MAC et l'adresse IP des clients soient fournies,
que ce soit par le biais de l'option 
.B dhcp-host 
ou dans le fichier
.I /etc/ethers
, et que l'option
.B dhcp-range 
soit prÃ©sente afin d'activer le serveur DHCP pour un rÃ©seau donnÃ© (L'option
.B --bootp-dynamic
supprime la nÃ©cessitÃ© des associations statiques). Le paramÃ¨tre
"filename" (nom de fichier) de la requÃªte BOOTP est utilisÃ© comme label, ainsi
que le label "bootp", permettant un certain contrÃ´le sur les options retournÃ©es
aux diffÃ©rentes classes d'hÃ´tes.


.SH CONFIGURATION EN TEMPS QUE SERVEUR FAISANT AUTORITÃ‰
.PP 
Configurer dnsmasq pour agir en temps que serveur DNS faisant autoritÃ© est
compliquÃ© par le fait que cela implique la configuration de serveurs DNS
externes pour mettre en place la dÃ©lÃ©gation. Seront prÃ©sentÃ©s ci-dessous trois
scÃ©narios de complexitÃ© croissante. Le prÃ©-requis pour chacun de ces scÃ©narios
est l'existence d'une adresse IP globalement disponible, d'un enregistrement de
type A ou AAAA pointant vers cette adresse, ainsi que d'un serveur DNS externe
capable d'effectuer la dÃ©lÃ©gation de la zone en question. Pour la premiÃ¨re
partie de ces explications, nous allons appeller serveur.exemple.com
l'enregistrement A (ou AAAA) de l'adresse globalement accessible, et
notre.zone.com la zone pour laquelle dnsmasq fait autoritÃ©.

La configuration la plus simple consiste en deux lignes de configuration,
sous la forme :
.nf
.B auth-server=serveur.exemple.com,eth0
.B auth-zone=notre.zone.com,1.2.3.0/24
.fi

ainsi que deux enregistrements dans le DNS externe :

.nf
serveur.exemple.com       A    192.0.43.10
notre.zone.com            NS    serveur.exemple.com
.fi

eth0 est l'interface rÃ©seau externe sur laquelle dnsmasq Ã©coute, dont l'adresse
IP (globalement accessible) est 192.0.43.10. 

A noter que l'adresse IP externe peut parfaitement Ãªtre dynamique (par exemple
attribuÃ©e par un FAI via DHCP ou PPP). Dans ce cas, l'enregistrement de type A
doit Ãªtre liÃ© Ã  cet enregistrement dynamique par l'une ou l'autre des techniques
habituelles de systÃ¨me DNS dynamique.

Un exemple plus complexe mais en pratique plus utile correspond au cas oÃ¹
l'adresse IP globalement accessible se trouve dans la zone pour laquelle
dnsmasq fait autoritÃ©, le plus souvent Ã  la racine. Dans ce cas nous avons :

.nf
.B auth-server=notre.zone.com,eth0
.B auth-zone=notre.zone.com,1.2.3.0/24
.fi

.nf
notre.zone.com             A    1.2.3.4
notre.zone.com            NS    our.zone.com
.fi

L'enregistrement A pour notre.zone.com est dorÃ©navant un enregistrement "colle"
qui rÃ©soud le problÃ¨me de poule et d'oeuf consistant Ã  trouver l'adresse IP
du serveur de nom pour notre.zone.com lorsque l'enregistrement se trouve dans
la zone en question. Il s'agit du seul rÃ´le de cet enregistrement : comme dnsmasq
fait dÃ©sormais autoritÃ© pour notre.zone.com, il doit Ã©galement fournir cet
enregistrement. Si l'adresse externe est statique, cela peut-Ãªtre rÃ©alisÃ© par
le biais d'une entrÃ©e dans
.B /etc/hosts 
ou via un
.B --host-record.

.nf
.B auth-server=notre.zone.com,eth0
.B host-record=notre.zone.com,1.2.3.4
.B auth-zone=notre.zone.com,1.2.3.0/24
.fi

Si l'adresse externe est dynamique, l'adresse associÃ©e Ã  notre.zone.com doit
Ãªtre dÃ©rivÃ©e de l'interface correspondante. Cela peut Ãªtre fait en utilisant
.B interface-name
Sous la forme :

.nf
.B auth-server=notre.zone.com,eth0
.B interface-name=notre.zone.com,eth0
.B auth-zone=notre.zone.com,1.2.3.0/24
.fi

La configuration finale rajoute Ã  cette base un serveur DNS secondaire. Il
s'agit d'un autre serveur DNS qui apprend les donnÃ©es DNS de la zone en
effectuant un transfert de zone, et qui joue le rÃ´le de serveur de secours
au cas oÃ¹ le serveur principal devenait inaccessible. La configuration
de ce serveur secondaire sort du cadre de cette page de manuel. Les Ã©lÃ©ments
de configuration Ã  rajouter dans dnsmasq sont les simples :

.nf
.B auth-sec-servers=secondaire.monfai.com
.fi

et

.nf
notre.zone.com           NS    secondaire.monfai.com
.fi

L'addition d'une option auth-sec-servers active les transferts de zone dans
dnsmasq, ce qui permet au serveur secondaire de venir collecter les donnÃ©es
DNS. Si vous souhaitez restreindre l'accÃ¨s Ã  ces donnÃ©es Ã  des hÃ´tes
spÃ©cifiques, vous pouvez le faire via :

.nf
.B auth-peer=<adresse IP du serveur secondaire>
.fi

Dnsmasq joue le rÃ´le de serveur faisant autoritÃ© pour les domaines in-addr.arpa
et ip6.arpa associÃ©s aux sous-rÃ©seaux dÃ©finis dans la dÃ©claration de zone
auth-zone, ce qui fait que les requÃªtes DNS inversÃ©es (de l'adresse vers
le nom) peuvent-simplement Ãªtre configurÃ©es avec un enregistrement NS
adÃ©quat. Par exemple, comme nous dÃ©finissons plus haut les adresses
1.2.3.0/24 :
.nf
 3.2.1.in-addr.arpa  NS    notre.zone.com
.fi

Veuillez noter que pour l'instant, les zones inverses ne sont pas
disponibles dans les transferts de zone, donc il est inutile de configurer
de serveur secondaire pour la rÃ©solution inverse.

.PP
Lorsque dnsmasq est configurÃ© en temps que serveur faisant autoritÃ©,
les donnÃ©es suivantes sont utilisÃ©es pour peupler la zone considÃ©rÃ©e :
.PP
.B --mx-host, --srv-host, --dns-rr, --txt-record, --naptr-record
, pour autant que les noms des enregistrements se trouvent dans la zone en
question.
.PP
.B --cname
pour peu que le nom soit dans le domaine. Si la cible du CNAME n'est
pas pleinement qualifiÃ©e, alors elle est qualifiÃ©e avec le nom de la
zone pour laquelle le serveur fait autoritÃ©.
.PP
Les adresses IPv4 et IPv6 extraites de /etc/hosts (et
.B --addn-hosts
) ainsi que les options
.B --host-record
fournissant des adresses situÃ©es dans l'un des sous-rÃ©seaux spÃ©cifiÃ©s dans 
.B --auth-zone.
.PP
Adresses spÃ©cifiÃ©es par
.B --interface-name.
Dans ce cas, l'adresse n'est pas limitÃ©e Ã  l'un des sous-rÃ©seaux donnÃ© dans
.B --auth-zone. 

.PP
Les adresses de baux DHCP, si l'adresse est situÃ©e dans l'un des sous-rÃ©seaux de
.B --auth-zone
OU dans une plage DHCP construite. Dans le mode par dÃ©faut, oÃ¹ le bail
DHCP a un nom non qualifiÃ©, et Ã©ventuellement pour un nom qualifiÃ© construit
via
.B --domain
, alors le nom dans la zone faisant autoritÃ© est construit Ã  partir du nom
non qualifiÃ© et du nom de domaine de la zone. Cela peut on non Ãªtre Ã©gal
celui fourni par
.B --domain.
Si l'option
.B --dhcp-fqdn
est fournie, alors les noms pleinemenet qualifiÃ©s associÃ©s aux baux DHCP
sont utilisÃ©s, dÃ¨s lors qu'ils correspondent au nom de domaine associÃ©
Ã  la zone.


.SH CODES DE SORTIE
.PP
0 - Dnsmasq s'est correctement lancÃ© en tÃ¢che de fond, ou alors s'est
correctement terminÃ© si le lancement en tÃ¢che de fond n'a pas Ã©tÃ© activÃ©.
.PP
1 - Un problÃ¨me de configuration a Ã©tÃ© dÃ©tectÃ©.
.PP
2 - Un problÃ¨me est survenu avec un accÃ¨s rÃ©seau (adresse dÃ©jÃ  utilisÃ©e,
tentative d'utiliser un port privilÃ©giÃ© sans les permissions nÃ©cessaires).
.PP
3 - Un problÃ¨me est survenu avec une opÃ©ration sur un systÃ¨me de fichier
(fichier ou rÃ©pertoire manquant, permissions).
.PP
4 - ImpossibilitÃ© d'allouer de la mÃ©moire.
.PP
5 - Autre problÃ¨me.
.PP
11 ou plus - un code de retour diffÃ©rent de 0 a Ã©tÃ© reÃ§u lors de l'appel au
processus "init" du script des bails. Le code de retour de Dnsmasq correspond
au code de retour du script plus 10.

.SH LIMITES
Les valeurs par dÃ©faut pour les limites de ressources de Dnsmasq sont en gÃ©nÃ©ral
conservatrices et appropriÃ©es pour des utilisations embarquÃ©es sur des machines
de type routeur ayant des processeurs lents et une mÃ©moire limitÃ©e. Sur du
matÃ©riel plus performant, il est possible d'augmenter les limites et de gÃ©rer
plus de clients. Les remarques suivantes s'appliquent Ã  Dnsmasq version 2.37 et
ultÃ©rieur : les versions prÃ©cÃ©dentes ne montaient pas en charge aussi bien.
 
.PP
Dnsmasq est capable de gÃ©rer le DNS et DHCP pour au moins un millier de clients.
Pour cela, la durÃ©e des bail ne doit pas Ãªtre trÃ¨s courte (moins d'une heure).
La valeur de
.B --dns-forward-max 
peut-Ãªtre augmentÃ©e : commencer par la rendre Ã©gale au nombre de clients et
l'augmenter si le DNS semble lent. Noter que la performance du DNS dÃ©pends
Ã©galement de la performance des serveurs amonts. La taille du cache DNS peut-
Ãªtre augmentÃ©e : la limite en dur est de 10000 entrÃ©es et la valeur par dÃ©faut
(150) est trÃ¨s basse. Envoyer un signal SIGUSR1 Ã  Dnsmasq le fait Ã©mettre des
informations utiles pour paramÃ©trer la taille de cache. Voir la section
.B NOTES
pour plus de dÃ©tails.
.PP
Le serveur TFTP intÃ©grÃ© est capable de plusieurs transferts de fichiers
simultanÃ©s : La limite absolue est liÃ©e au nombre maximal de descripteurs de
fichiers allouÃ© Ã  un processus et Ã  la capacitÃ© de l'appel systÃ¨me select() Ã 
gÃ©rer un grand nombre de HANDLE de fichier. Si la limite est fixÃ©e trop haut par
le biais de
.B --tftp-max
elle sera rÃ©duite et la limite actuelle sera enregistrÃ©e au dÃ©marrage. Il faut
noter que plus de transferts sont possible lorsque le mÃªme fichier est transmis
au lieu d'avoir un fichier diffÃ©rent pour chaque transfert.

.PP
Il est possible d'utiliser Dnsmasq pour bloquer la publicitÃ© sur la toile
en associant des serveurs de publicitÃ© bien connus Ã  l'adresse 127.0.0.1 ou
0.0.0.0 par le biais du fichier
.B /etc/hosts 
ou d'un fichier d'hÃ´te additionnel. Cette liste peut-Ãªtre trÃ¨s longue, Dnsmasq
ayant Ã©tÃ© testÃ© avec succÃ¨s avec un million de noms. Cette taille de fichier
nÃ©cessite un processeur Ã  1 Ghz et environ 60 Mo de RAM.

.SH INTERNATIONALISATION
Dnsmasq peut Ãªtre compilÃ© pour supporter l'internationalisation. Pour cela,
les cibles "all-i18n" et "install-i18n" doivent Ãªtre donnÃ©es Ã  make, en lieu
et place des cibles standards "all" et "install". Lorsque compilÃ© avec le
support de l'internationalisation, dnsmasq supporte les noms de domaines
internationalisÃ©s ("internationalised domain names" ou IDN), et les messages de
traces ("logs") sont Ã©crits dans la langue locale. Les noms de domaines dans
/etc/hosts, /etc/ethers et /etc/dnsmasq.conf contenant des caractÃ¨res
non-ASCII seront transformÃ©s selon la reprÃ©sentation punycode interne
aux DNS. Veuillez noter que dnsmasq dÃ©termine la langue pour les messages
ainsi que le jeu de caractÃ¨res susceptible d'Ãªtre utilisÃ© dans les fichiers
de configuration Ã  partir de la variable d'environnement LANG. Ceci devrait
Ãªtre configurÃ© Ã  la valeur par dÃ©faut du systÃ¨me par les scripts dÃ©marrant
dnsmasq. Lorsque les fichiers de configuration sont Ã©ditÃ©s, veuillez faire
attention Ã  le faire en utilisant la valeur de locale par dÃ©faut du systÃ¨me
et non une valeur spÃ©cifique Ã  l'utilisateur, puisque dnsmasq n'a aucun
moyen de dÃ©terminer directement la valeur de jeu de caractÃ¨re utilisÃ©,
et assume de ce fait qu'il s'agit de la valeur par dÃ©faut du systÃ¨me.

.SH FICHIERS
.IR /etc/dnsmasq.conf 

.IR /usr/local/etc/dnsmasq.conf
.IR /var/run/dnsmasq/resolv.conf
.IR /etc/ppp/resolv.conf
.IR /etc/dhcpc/resolv.conf

.IR /etc/resolv.conf

.IR /etc/hosts

.IR /etc/ethers

.IR /var/lib/misc/dnsmasq.leases 

.IR /var/db/dnsmasq.leases

.IR /var/run/dnsmasq.pid
.SH VOIR AUSSI
.BR hosts (5), 
.BR resolver (5)
.SH AUTEUR
Cette page de manuel a Ã©tÃ© Ã©crite par Simon Kelley <simon@thekelleys.org.uk>.

La traduction dans un franÃ§ais bancal a Ã©tÃ© commise par Gildas Le Nadan
<3ntr0p13@gmail.com> : Toute rÃ©vision/correction permettant de corriger
orthographe ou grammaire mais surtout les Ã©ventuelles fautes de sens sera la
bienvenue!

